id: no-curl-pulumi
language: bash
severity: error
message: "Use official GitHub Action instead of curl|sh for Pulumi"
note: |
  Anti-pattern: curl -fsSL https://get.pulumi.com | sh

  Use instead:
  - pulumi/actions@v6 (for pulumi CLI)
  - pulumi/auth-actions@v1 (for OIDC auth)
  - pulumi/esc-action@v1 (for ESC config)
rule:
  pattern: curl $$ARGS get.pulumi.com $$REST
