{
  "permissions": {
    "allow": [
      "Read",
      "Grep(*)",
      "Glob(*)",
      "Bash(ls:*)",
      "Bash(cat:*)",
      "Bash(head:*)",
      "Bash(tail:*)",
      "Bash(find:*)",
      "Bash(fd:*)",
      "Bash(rg:*)",
      "Bash(wc:*)",
      "Bash(which:*)",
      "Bash(echo:*)",
      "Bash(pwd)",
      "Bash(cd:*)",
      "Bash(mkdir:*)",
      "Bash(cp:*)",
      "Bash(mv:*)",
      "Bash(rm:*)",
      "Bash(touch:*)",
      "Bash(tree:*)",
      "Bash(eza:*)",
      "Bash(bat:*)",
      "Bash(delta:*)",
      "Bash(dust:*)",
      "Bash(duf:*)",
      "Bash(sort:*)",
      "Bash(uniq:*)",
      "Bash(jq:*)",
      "Bash(curl:*)",
      "Bash(bun:*)",
      "Bash(bunx:*)",
      "Bash(npm:*)",
      "Bash(npx:*)",
      "Bash(node:*)",
      "Bash(python:*)",
      "Bash(python3:*)",
      "Bash(uv:*)",
      "Bash(uvx:*)",
      "Bash(ruff:*)",
      "Bash(pytest:*)",
      "Bash(make:*)",
      "Bash(just:*)",
      "Bash(cargo:*)",
      "Bash(git:*)",
      "Bash(gh:*)",
      "Bash(biome:*)",
      "Bash(tsc:*)",
      "Bash(playwright:*)",
      "Bash(wrangler:*)",
      "Bash(docker:*)",
      "Bash(docker-compose:*)",
      "Bash(kubectl:*)",
      "Bash(terraform:*)",
      "Bash(nix:*)",
      "Bash(nix-shell:*)",
      "Bash(darwin-rebuild:*)",
      "Bash(home-manager:*)",
      "Bash(alejandra:*)",
      "Bash(nixfmt:*)",
      "Bash(shfmt:*)",
      "Bash(stylua:*)",
      "Write(*.ts)",
      "Write(*.tsx)",
      "Write(*.js)",
      "Write(*.jsx)",
      "Write(*.json)",
      "Write(*.md)",
      "Write(*.py)",
      "Write(*.nix)",
      "Write(*.toml)",
      "Write(*.yaml)",
      "Write(*.yml)",
      "Write(*.sh)",
      "Write(*.bash)",
      "Write(*.sql)",
      "Write(*.css)",
      "Write(*.scss)",
      "Write(*.html)",
      "Write(*.lua)",
      "Write(*.kdl)",
      "Edit(*.ts)",
      "Edit(*.tsx)",
      "Edit(*.js)",
      "Edit(*.jsx)",
      "Edit(*.json)",
      "Edit(*.md)",
      "Edit(*.py)",
      "Edit(*.nix)",
      "Edit(*.toml)",
      "Edit(*.yaml)",
      "Edit(*.yml)",
      "Edit(*.sh)",
      "Edit(*.bash)",
      "Edit(*.sql)",
      "Edit(*.css)",
      "Edit(*.scss)",
      "Edit(*.html)",
      "Edit(*.lua)",
      "Edit(*.kdl)"
    ],
    "deny": [
      "Read(*/.env)",
      "Read(*/.env.*)",
      "Read(*/.dev.vars)",
      "Read(*/secrets*)",
      "Read(*/*.pem)",
      "Read(*/*.key)",
      "Read(*/.ssh/*)",
      "Read(*/.gnupg/*)",
      "Read(*/.netrc)",
      "Write(*/.env)",
      "Write(*/.env.*)",
      "Write(*/.dev.vars)",
      "Bash(rm -rf /)",
      "Bash(rm -rf ~)",
      "Bash(sudo:*)",
      "Bash(chmod 777:*)",
      "Bash(git push --force:*)",
      "Bash(git reset --hard:*)",
      "Write(*/.git/*)",
      "Edit(*/.git/*)"
    ]
  },
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "Write(*.ts)|Write(*.tsx)|Write(*.js)|Write(*.jsx)|Edit(*.ts)|Edit(*.tsx)|Edit(*.js)|Edit(*.jsx)",
        "hooks": [
          {
            "type": "command",
            "command": "bunx biome check --write \"$CLAUDE_FILE_PATHS\" 2>/dev/null || true",
            "timeout": 15
          }
        ]
      },
      {
        "matcher": "Write(*.py)|Edit(*.py)",
        "hooks": [
          {
            "type": "command",
            "command": "ruff format \"$CLAUDE_FILE_PATHS\" && ruff check --fix \"$CLAUDE_FILE_PATHS\" 2>/dev/null || true",
            "timeout": 30
          }
        ]
      },
      {
        "matcher": "Write(*.nix)|Edit(*.nix)",
        "hooks": [
          {
            "type": "command",
            "command": "alejandra --quiet \"$CLAUDE_FILE_PATHS\" 2>/dev/null || nixfmt \"$CLAUDE_FILE_PATHS\" 2>/dev/null || true",
            "timeout": 15
          }
        ]
      },
      {
        "matcher": "Write(*.json)|Edit(*.json)",
        "hooks": [
          {
            "type": "command",
            "command": "bunx biome check --write \"$CLAUDE_FILE_PATHS\" 2>/dev/null || jq '.' \"$CLAUDE_FILE_PATHS\" > /tmp/jq_tmp && mv /tmp/jq_tmp \"$CLAUDE_FILE_PATHS\" 2>/dev/null || true",
            "timeout": 15
          }
        ]
      },
      {
        "matcher": "Write(*.sh)|Write(*.bash)|Edit(*.sh)|Edit(*.bash)",
        "hooks": [
          {
            "type": "command",
            "command": "shfmt -w \"$CLAUDE_FILE_PATHS\" 2>/dev/null || true",
            "timeout": 10
          }
        ]
      },
      {
        "matcher": "Write(*.yaml)|Write(*.yml)|Write(*.toml)|Edit(*.yaml)|Edit(*.yml)|Edit(*.toml)",
        "hooks": [
          {
            "type": "command",
            "command": "npx prettier --write \"$CLAUDE_FILE_PATHS\" 2>/dev/null || true",
            "timeout": 15
          }
        ]
      },
      {
        "matcher": "Write(*.lua)|Edit(*.lua)",
        "hooks": [
          {
            "type": "command",
            "command": "stylua \"$CLAUDE_FILE_PATHS\" 2>/dev/null || true",
            "timeout": 10
          }
        ]
      },
      {
        "matcher": "Write(*.css)|Write(*.scss)|Edit(*.css)|Edit(*.scss)",
        "hooks": [
          {
            "type": "command",
            "command": "npx prettier --write \"$CLAUDE_FILE_PATHS\" 2>/dev/null || true",
            "timeout": 15
          }
        ]
      },
      {
        "matcher": "Write(*.sql)|Edit(*.sql)",
        "hooks": [
          {
            "type": "command",
            "command": "npx sql-formatter --fix \"$CLAUDE_FILE_PATHS\" 2>/dev/null || true",
            "timeout": 10
          }
        ]
      },
      {
        "matcher": "Edit|Write",
        "hooks": [
          {
            "type": "command",
            "command": "bash \"$HOME/dotfiles/config/claude-code/evolution/hooks/post-edit.sh\"",
            "timeout": 10
          }
        ]
      }
    ],
    "PreToolUse": [
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "if [[ \"$CLAUDE_TOOL_INPUT\" == *\"rm -rf /\"* ]] || [[ \"$CLAUDE_TOOL_INPUT\" == *\"rm -rf ~\"* ]]; then echo 'BLOCKED: Dangerous recursive delete' >&2; exit 1; fi",
            "timeout": 5
          }
        ]
      },
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "bun run \"$HOME/dotfiles/config/claude-code/evolution/hooks/conventional-commit.ts\"",
            "timeout": 5
          }
        ]
      },
      {
        "matcher": "Write",
        "hooks": [
          {
            "type": "command",
            "command": "bun run \"$HOME/dotfiles/config/claude-code/evolution/hooks/forbidden-files.ts\"",
            "timeout": 5
          }
        ]
      },
      {
        "matcher": "Write(*.ts)|Write(*.tsx)|Write(*.js)|Write(*.jsx)|Edit(*.ts)|Edit(*.tsx)|Edit(*.js)|Edit(*.jsx)",
        "hooks": [
          {
            "type": "command",
            "command": "bun run \"$HOME/dotfiles/config/claude-code/evolution/hooks/forbidden-imports.ts\"",
            "timeout": 10
          }
        ]
      },
      {
        "matcher": "Write(*.ts)|Write(*.tsx)|Edit(*.ts)|Edit(*.tsx)",
        "hooks": [
          {
            "type": "command",
            "command": "bun run \"$HOME/dotfiles/config/claude-code/evolution/hooks/any-type-detector.ts\"",
            "timeout": 10
          }
        ]
      },
      {
        "matcher": "Write|Edit|MultiEdit",
        "hooks": [
          {
            "type": "command",
            "command": "bun run \"$HOME/dotfiles/config/claude-code/evolution/hooks/tdd-enforcer.ts\"",
            "timeout": 10
          }
        ]
      }
    ],
    "SessionStart": [
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "echo \"[$(date '+%Y-%m-%d %H:%M:%S')] Session: $(pwd)\" >> ~/.claude/session.log"
          }
        ]
      },
      {
        "hooks": [
          {
            "type": "command",
            "command": "bash \"$HOME/dotfiles/config/claude-code/evolution/hooks/session-start.sh\"",
            "timeout": 5
          }
        ]
      }
    ],
    "Stop": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "echo \"[$(date '+%Y-%m-%d %H:%M:%S')] Session ended | Dir: $(basename \"$PWD\") | Files: $(git diff --name-only HEAD~5 2>/dev/null | wc -l | tr -d ' ') modified | Commits: $(git log --oneline --since='1 hour ago' 2>/dev/null | wc -l | tr -d ' ')\" >> ~/.claude/session.log",
            "timeout": 10
          }
        ]
      },
      {
        "hooks": [
          {
            "type": "command",
            "command": "bash \"$HOME/dotfiles/config/claude-code/evolution/hooks/session-stop.sh\"",
            "timeout": 30
          }
        ]
      },
      {
        "hooks": [
          {
            "type": "command",
            "command": "bun run \"$HOME/dotfiles/config/claude-code/evolution/hooks/verification-gate.ts\"",
            "timeout": 15
          }
        ]
      },
      {
        "hooks": [
          {
            "type": "command",
            "command": "bun run \"$HOME/dotfiles/config/claude-code/evolution/hooks/assumption-detector.ts\"",
            "timeout": 15
          }
        ]
      }
    ]
  },
  "alwaysThinkingEnabled": true,
  "cleanupPeriodDays": 90,
  "includeCoAuthoredBy": false,
  "verbose": false,
  "statusLine": {
    "type": "command",
    "command": "input=$(cat); dir=$(echo \"$input\" | jq -r '.workspace.current_dir'); branch=$(cd \"$dir\" && git branch --show-current 2>/dev/null); dirty=$(cd \"$dir\" && git status --porcelain 2>/dev/null | wc -l | tr -d ' '); printf \"%s%s%s\" \"$(basename \"$dir\")\" \"${branch:+ @ $branch}\" \"${dirty:+0 [$dirty]}\""
  }
}
