"use strict";var i=Object.defineProperty;var P=Object.getOwnPropertyDescriptor;var T=Object.getOwnPropertyNames;var R=Object.prototype.hasOwnProperty;var U=(r,t)=>{for(var a in t)i(r,a,{get:t[a],enumerable:!0})},E=(r,t,a,e)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of T(t))!R.call(r,s)&&s!==a&&i(r,s,{get:()=>t[s],enumerable:!(e=P(t,s))||e.enumerable});return r};var L=r=>E(i({},"__esModule",{value:!0}),r);var b={};U(b,{default:()=>d});module.exports=L(b);var l=require("@raycast/api");var o=require("@raycast/api");var g=[{name:"Google Search",url:"google.com",allowParams:["q","ie"]},{name:"Baidu Search",url:"baidu.com",allowParams:["wd","ie"]},{name:"Bing Search",url:"bing.com",allowParams:["q"]},{name:"Netease Music",url:"music.163.com",allowParams:["id"]},{name:"Youtube",url:"youtube.com",allowParams:["v","search_query"]},{name:"Instagram Reel",url:"instagram.com/reel",allowParams:[]}];function c(r){let t=/(https?:\/\/[^\s]+)/g;return r.match(t)??[]}function p(r,t){let a=c(r);for(let e of a)r=r.replace(e,t.shift()||e);return r}function f(r,t){let a=r.split("?");if(a.length<2)return r;let e=a[1].split("&");if(t.length>0){let s=e.filter(n=>t.includes(n.split("=")[0]));return`${a[0]}?${s.join("&")}`}return a[0]}async function u(r){let t=c(r);if(t.length===0){await(0,o.showHUD)("No URL found");return}console.log("raw urls",t);let a=[];for(let n of t){let m=g.find(h=>n.includes(h.url))?.allowParams||[];console.log("allow params",m);let y=f(n,m);a.push(y)}console.log("new urls",a);let e=p(r,a);console.log("new text",e),await o.Clipboard.copy(e);let s=await(0,o.getFrontmostApplication)();await(0,o.showToast)({title:"Tracking parameters removed",message:e,style:o.Toast.Style.Success,primaryAction:{title:`Paste Cleaned URL to ${s.name}`,onAction:async()=>{await o.Clipboard.paste(e)}}})}async function w(r){try{return{data:await r,error:null}}catch(t){return{data:null,error:t}}}async function d(){let{data:r,error:t}=await w(l.Clipboard.readText());if(t||!r){await(0,l.showHUD)("Failed to get clipboard text");return}await u(r)}
