"use strict";var i=Object.defineProperty;var P=Object.getOwnPropertyDescriptor;var T=Object.getOwnPropertyNames;var R=Object.prototype.hasOwnProperty;var U=(t,r)=>{for(var e in r)i(t,e,{get:r[e],enumerable:!0})},E=(t,r,e,a)=>{if(r&&typeof r=="object"||typeof r=="function")for(let s of T(r))!R.call(t,s)&&s!==e&&i(t,s,{get:()=>r[s],enumerable:!(a=P(r,s))||a.enumerable});return t};var S=t=>E(i({},"__esModule",{value:!0}),t);var x={};U(x,{default:()=>d});module.exports=S(x);var n=require("@raycast/api");var o=require("@raycast/api");var g=[{name:"Google Search",url:"google.com",allowParams:["q","ie"]},{name:"Baidu Search",url:"baidu.com",allowParams:["wd","ie"]},{name:"Bing Search",url:"bing.com",allowParams:["q"]},{name:"Netease Music",url:"music.163.com",allowParams:["id"]},{name:"Youtube",url:"youtube.com",allowParams:["v","search_query"]},{name:"Instagram Reel",url:"instagram.com/reel",allowParams:[]}];function c(t){let r=/(https?:\/\/[^\s]+)/g;return t.match(r)??[]}function p(t,r){let e=c(t);for(let a of e)t=t.replace(a,r.shift()||a);return t}function w(t,r){let e=t.split("?");if(e.length<2)return t;let a=e[1].split("&");if(r.length>0){let s=a.filter(l=>r.includes(l.split("=")[0]));return`${e[0]}?${s.join("&")}`}return e[0]}async function u(t){let r=c(t);if(r.length===0){await(0,o.showHUD)("No URL found");return}console.log("raw urls",r);let e=[];for(let l of r){let m=g.find(h=>l.includes(h.url))?.allowParams||[];console.log("allow params",m);let y=w(l,m);e.push(y)}console.log("new urls",e);let a=p(t,e);console.log("new text",a),await o.Clipboard.copy(a);let s=await(0,o.getFrontmostApplication)();await(0,o.showToast)({title:"Tracking parameters removed",message:a,style:o.Toast.Style.Success,primaryAction:{title:`Paste Cleaned URL to ${s.name}`,onAction:async()=>{await o.Clipboard.paste(a)}}})}async function f(t){try{return{data:await t,error:null}}catch(r){return{data:null,error:r}}}async function d(){await(0,n.showToast)({style:n.Toast.Style.Animated,title:"Getting selected text..."});let{data:t,error:r}=await f((0,n.getSelectedText)());if(r){await(0,n.showHUD)("Failed to get selected text");return}await u(t)}
