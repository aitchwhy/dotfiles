"use strict";var z=Object.create;var d=Object.defineProperty;var B=Object.getOwnPropertyDescriptor;var E=Object.getOwnPropertyNames;var N=Object.getPrototypeOf,j=Object.prototype.hasOwnProperty;var C=(e,t)=>{for(var r in t)d(e,r,{get:t[r],enumerable:!0})},y=(e,t,r,c)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of E(t))!j.call(e,i)&&i!==r&&d(e,i,{get:()=>t[i],enumerable:!(c=B(t,i))||c.enumerable});return e};var O=(e,t,r)=>(r=e!=null?z(N(e)):{},y(t||!e||!e.__esModule?d(r,"default",{value:e,enumerable:!0}):r,e)),b=e=>y(d({},"__esModule",{value:!0}),e);var J={};C(J,{default:()=>k});module.exports=b(J);var n=require("@raycast/api"),w=O(require("path"));var h=require("@raycast/api"),g=require("path"),S=require("fs/promises"),x=require("child_process");async function F(e,...t){let r=(0,g.join)(h.environment.assetsPath,"compiled_raycast_swift/swift");return await(0,S.chmod)(r,"755"),new Promise((c,i)=>{let s=[e];for(let a of t)try{s.push(JSON.stringify(a,(o,u)=>u===void 0?null:u))}catch(o){i(new m("Failed to serialize input to JSON: "+o.message));return}let f=(0,x.spawn)(r,s),l=[],p=[];f.stdout?.on("data",a=>{l.push(a.toString())}),f.stderr?.on("data",a=>{p.push(a.toString())}),f.on("exit",a=>{if(a===0)try{let o=l.join("").trim();o.length!=0?c(JSON.parse(o)):c(null)}catch(o){let u=new m("Failed to deserialize result from JSON: "+o.message);u.stdout=l.join("").trim(),u.stderr=p.join("").trim(),i(u)}else{let o=new m(p.join("").trim()||l.join("").trim()||"Could not get any data");o.stdout=l.join("").trim(),o.stderr=p.join("").trim(),i(o)}}),f.on("error",a=>{i(a)})})}async function P(e,t,r){return await F("splitByFileSize",e,t,r)}async function D(e){return await F("isPDFDocumentLocked",e)}var m=class extends Error{constructor(t){super(t),this.name="SwiftError"}};async function k(e){try{let t=parseFloat(e.arguments.maxSizeMB);if(isNaN(t)||t<=0)throw new Error("A positive number is required");let r=await(0,n.getSelectedFinderItems)();if(r.length===0)throw new Error("You must select at least one PDF file in Finder");for(let s of r){if(w.default.extname(s.path).toLowerCase()!==".pdf")throw new Error("Only PDF files should be selected in Finder");if(await D(s.path))throw new Error(`"${w.default.basename(s.path)}" is password-protected`)}await(0,n.closeMainWindow)();let i=(0,n.getPreferenceValues)().suffix||void 0;for(let s of r)await(0,n.showToast)({style:n.Toast.Style.Animated,title:`Splitting "${w.default.basename(s.path)}"`}),await P(s.path,t,i);await(0,n.showToast)({style:n.Toast.Style.Success,title:`PDF file${r.length>1?"s":""} split successfully`})}catch(t){await(0,n.showToast)({style:n.Toast.Style.Failure,title:t instanceof Error?t.message:String(t)})}}
