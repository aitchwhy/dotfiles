"use strict";var k=Object.create;var d=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var N=Object.getOwnPropertyNames;var b=Object.getPrototypeOf,j=Object.prototype.hasOwnProperty;var B=(e,t)=>{for(var r in t)d(e,r,{get:t[r],enumerable:!0})},g=(e,t,r,c)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of N(t))!j.call(e,o)&&o!==r&&d(e,o,{get:()=>t[o],enumerable:!(c=E(t,o))||c.enumerable});return e};var O=(e,t,r)=>(r=e!=null?k(b(e)):{},g(t||!e||!e.__esModule?d(r,"default",{value:e,enumerable:!0}):r,e)),z=e=>g(d({},"__esModule",{value:!0}),e);var J={};B(J,{default:()=>D});module.exports=z(J);var n=require("@raycast/api"),w=O(require("path"));var y=require("@raycast/api"),h=require("path"),S=require("fs/promises"),x=require("child_process");async function F(e,...t){let r=(0,h.join)(y.environment.assetsPath,"compiled_raycast_swift/swift");return await(0,S.chmod)(r,"755"),new Promise((c,o)=>{let s=[e];for(let a of t)try{s.push(JSON.stringify(a,(i,u)=>u===void 0?null:u))}catch(i){o(new l("Failed to serialize input to JSON: "+i.message));return}let m=(0,x.spawn)(r,s),f=[],p=[];m.stdout?.on("data",a=>{f.push(a.toString())}),m.stderr?.on("data",a=>{p.push(a.toString())}),m.on("exit",a=>{if(a===0)try{let i=f.join("").trim();i.length!=0?c(JSON.parse(i)):c(null)}catch(i){let u=new l("Failed to deserialize result from JSON: "+i.message);u.stdout=f.join("").trim(),u.stderr=p.join("").trim(),o(u)}else{let i=new l(p.join("").trim()||f.join("").trim()||"Could not get any data");i.stdout=f.join("").trim(),i.stderr=p.join("").trim(),o(i)}}),m.on("error",a=>{o(a)})})}async function P(e){return await F("isPDFDocumentLocked",e)}async function C(e,t,r){return await F("splitByPageCount",e,t,r)}var l=class extends Error{constructor(t){super(t),this.name="SwiftError"}};async function D(e){try{let t=Number(e.arguments.pageCount);if(!Number.isInteger(t)||t<=0)throw new Error("A positive integer is required");let r=await(0,n.getSelectedFinderItems)();if(r.length===0)throw new Error("You must select at least one PDF file in Finder");for(let s of r){if(w.default.extname(s.path).toLowerCase()!==".pdf")throw new Error("Only PDF files should be selected in Finder");if(await P(s.path))throw new Error(`"${w.default.basename(s.path)}" is password-protected`)}await(0,n.closeMainWindow)();let o=(0,n.getPreferenceValues)().suffix||void 0;for(let s of r)await(0,n.showToast)({style:n.Toast.Style.Animated,title:`Splitting "${w.default.basename(s.path)}"`}),await C(s.path,t,o);await(0,n.showToast)({style:n.Toast.Style.Success,title:`PDF file${r.length>1?"s":""} split successfully`})}catch(t){await(0,n.showToast)({style:n.Toast.Style.Failure,title:t instanceof Error?t.message:String(t)})}}
