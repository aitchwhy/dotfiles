"use strict";var Zn=Object.create;var Wt=Object.defineProperty;var qn=Object.getOwnPropertyDescriptor;var Dn=Object.getOwnPropertyNames;var Ln=Object.getPrototypeOf,Fn=Object.prototype.hasOwnProperty;var Mn=(b,d)=>()=>(d||b((d={exports:{}}).exports,d),d.exports),Un=(b,d)=>{for(var E in d)Wt(b,E,{get:d[E],enumerable:!0})},wr=(b,d,E,T)=>{if(d&&typeof d=="object"||typeof d=="function")for(let A of Dn(d))!Fn.call(b,A)&&A!==E&&Wt(b,A,{get:()=>d[A],enumerable:!(T=qn(d,A))||T.enumerable});return b};var Tr=(b,d,E)=>(E=b!=null?Zn(Ln(b)):{},wr(d||!b||!b.__esModule?Wt(E,"default",{value:b,enumerable:!0}):E,b)),Cn=b=>wr(Wt({},"__esModule",{value:!0}),b);var Ir=Mn((Vt,it)=>{var jt=void 0,Jt=function(b){return jt||(jt=new Promise(function(d,E){var T=typeof b<"u"?b:{},A=T.onAbort;T.onAbort=function(t){E(new Error(t)),A&&A(t)},T.postRun=T.postRun||[],T.postRun.push(function(){d(T)}),it=void 0;var o;o||=typeof T<"u"?T:{},o.onRuntimeInitialized=function(){function t(s,l){switch(typeof l){case"boolean":On(s,l?1:0);break;case"number":Nn(s,l);break;case"string":An(s,l,-1,-1);break;case"object":if(l===null)_r(s);else if(l.length!=null){var h=Ht(l,Gt);Sn(s,h,l.length,-1),Pt(h)}else Qt(s,"Wrong API use : tried to return a value of an unknown type ("+l+").",-1);break;default:_r(s)}}function e(s,l){for(var h=[],_=0;_<s;_+=1){var g=W(l+4*_,"i32"),O=wn(g);if(O===1||O===2)g=vn(g);else if(O===3)g=In(g);else if(O===4){O=g,g=Tn(O),O=gn(O);for(var x=new Uint8Array(g),H=0;H<g;H+=1)x[H]=F[O+H];g=x}else g=null;h.push(g)}return h}function r(s,l){this.La=s,this.db=l,this.Ja=1,this.fb=[]}function n(s,l){if(this.db=l,l=st(s)+1,this.Ya=Kt(l),this.Ya===null)throw Error("Unable to allocate memory for the SQL string");at(s,S,this.Ya,l),this.eb=this.Ya,this.Ua=this.ib=null}function i(s){if(this.filename="dbfile_"+(4294967295*Math.random()>>>0),s!=null){var l=this.filename,h="/",_=l;if(h&&(h=typeof h=="string"?h:_t(h),_=l?j(h+"/"+l):h),l=Ge(!0,!0),_=Lt(_,(l!==void 0?l:438)&4095|32768,0),s){if(typeof s=="string"){h=Array(s.length);for(var g=0,O=s.length;g<O;++g)h[g]=s.charCodeAt(g);s=h}Mt(_,l|146),h=lt(_,577),rr(h,s,0,s.length,0),ce(h),Mt(_,l)}}this.handleError(p(this.filename,a)),this.db=W(a,"i32"),br(this.db),this.Za={},this.Na={}}var a=Y(4),u=o.cwrap,p=u("sqlite3_open","number",["string","number"]),v=u("sqlite3_close_v2","number",["number"]),w=u("sqlite3_exec","number",["number","string","number","number","number"]),L=u("sqlite3_changes","number",["number"]),M=u("sqlite3_prepare_v2","number",["number","string","number","number","number"]),cr=u("sqlite3_sql","string",["number"]),rn=u("sqlite3_normalized_sql","string",["number"]),dr=u("sqlite3_prepare_v2","number",["number","number","number","number","number"]),nn=u("sqlite3_bind_text","number",["number","number","number","number","number"]),mr=u("sqlite3_bind_blob","number",["number","number","number","number","number"]),on=u("sqlite3_bind_double","number",["number","number","number"]),sn=u("sqlite3_bind_int","number",["number","number","number"]),an=u("sqlite3_bind_parameter_index","number",["number","string"]),un=u("sqlite3_step","number",["number"]),ln=u("sqlite3_errmsg","string",["number"]),fn=u("sqlite3_column_count","number",["number"]),hn=u("sqlite3_data_count","number",["number"]),cn=u("sqlite3_column_double","number",["number","number"]),pr=u("sqlite3_column_text","string",["number","number"]),dn=u("sqlite3_column_blob","number",["number","number"]),mn=u("sqlite3_column_bytes","number",["number","number"]),pn=u("sqlite3_column_type","number",["number","number"]),En=u("sqlite3_column_name","string",["number","number"]),_n=u("sqlite3_reset","number",["number"]),yn=u("sqlite3_clear_bindings","number",["number"]),bn=u("sqlite3_finalize","number",["number"]),Er=u("sqlite3_create_function_v2","number","number string number number number number number number number".split(" ")),wn=u("sqlite3_value_type","number",["number"]),Tn=u("sqlite3_value_bytes","number",["number"]),In=u("sqlite3_value_text","string",["number"]),gn=u("sqlite3_value_blob","number",["number"]),vn=u("sqlite3_value_double","number",["number"]),Nn=u("sqlite3_result_double","",["number","number"]),_r=u("sqlite3_result_null","",["number"]),An=u("sqlite3_result_text","",["number","string","number","number"]),Sn=u("sqlite3_result_blob","",["number","number","number","number"]),On=u("sqlite3_result_int","",["number","number"]),Qt=u("sqlite3_result_error","",["number","string","number"]),yr=u("sqlite3_aggregate_context","number",["number","number"]),br=u("RegisterExtensionFunctions","number",["number"]);r.prototype.bind=function(s){if(!this.La)throw"Statement closed";return this.reset(),Array.isArray(s)?this.wb(s):s!=null&&typeof s=="object"?this.xb(s):!0},r.prototype.step=function(){if(!this.La)throw"Statement closed";this.Ja=1;var s=un(this.La);switch(s){case 100:return!0;case 101:return!1;default:throw this.db.handleError(s)}},r.prototype.rb=function(s){return s==null&&(s=this.Ja,this.Ja+=1),cn(this.La,s)},r.prototype.Ab=function(s){if(s==null&&(s=this.Ja,this.Ja+=1),s=pr(this.La,s),typeof BigInt!="function")throw Error("BigInt is not supported");return BigInt(s)},r.prototype.Bb=function(s){return s==null&&(s=this.Ja,this.Ja+=1),pr(this.La,s)},r.prototype.getBlob=function(s){s==null&&(s=this.Ja,this.Ja+=1);var l=mn(this.La,s);s=dn(this.La,s);for(var h=new Uint8Array(l),_=0;_<l;_+=1)h[_]=F[s+_];return h},r.prototype.get=function(s,l){l=l||{},s!=null&&this.bind(s)&&this.step(),s=[];for(var h=hn(this.La),_=0;_<h;_+=1)switch(pn(this.La,_)){case 1:var g=l.useBigInt?this.Ab(_):this.rb(_);s.push(g);break;case 2:s.push(this.rb(_));break;case 3:s.push(this.Bb(_));break;case 4:s.push(this.getBlob(_));break;default:s.push(null)}return s},r.prototype.getColumnNames=function(){for(var s=[],l=fn(this.La),h=0;h<l;h+=1)s.push(En(this.La,h));return s},r.prototype.getAsObject=function(s,l){s=this.get(s,l),l=this.getColumnNames();for(var h={},_=0;_<l.length;_+=1)h[l[_]]=s[_];return h},r.prototype.getSQL=function(){return cr(this.La)},r.prototype.getNormalizedSQL=function(){return rn(this.La)},r.prototype.run=function(s){return s!=null&&this.bind(s),this.step(),this.reset()},r.prototype.nb=function(s,l){l==null&&(l=this.Ja,this.Ja+=1),s=Me(s);var h=Ht(s,Gt);this.fb.push(h),this.db.handleError(nn(this.La,l,h,s.length-1,0))},r.prototype.vb=function(s,l){l==null&&(l=this.Ja,this.Ja+=1);var h=Ht(s,Gt);this.fb.push(h),this.db.handleError(mr(this.La,l,h,s.length,0))},r.prototype.mb=function(s,l){l==null&&(l=this.Ja,this.Ja+=1),this.db.handleError((s===(s|0)?sn:on)(this.La,l,s))},r.prototype.yb=function(s){s==null&&(s=this.Ja,this.Ja+=1),mr(this.La,s,0,0,0)},r.prototype.ob=function(s,l){switch(l==null&&(l=this.Ja,this.Ja+=1),typeof s){case"string":this.nb(s,l);return;case"number":this.mb(s,l);return;case"bigint":this.nb(s.toString(),l);return;case"boolean":this.mb(s+0,l);return;case"object":if(s===null){this.yb(l);return}if(s.length!=null){this.vb(s,l);return}}throw"Wrong API use : tried to bind a value of an unknown type ("+s+")."},r.prototype.xb=function(s){var l=this;return Object.keys(s).forEach(function(h){var _=an(l.La,h);_!==0&&l.ob(s[h],_)}),!0},r.prototype.wb=function(s){for(var l=0;l<s.length;l+=1)this.ob(s[l],l+1);return!0},r.prototype.reset=function(){return this.freemem(),yn(this.La)===0&&_n(this.La)===0},r.prototype.freemem=function(){for(var s;(s=this.fb.pop())!==void 0;)Pt(s)},r.prototype.free=function(){this.freemem();var s=bn(this.La)===0;return delete this.db.Za[this.La],this.La=0,s},n.prototype.next=function(){if(this.Ya===null)return{done:!0};if(this.Ua!==null&&(this.Ua.free(),this.Ua=null),!this.db.db)throw this.gb(),Error("Database closed");var s=It(),l=Y(4);pt(a),pt(l);try{this.db.handleError(dr(this.db.db,this.eb,-1,a,l)),this.eb=W(l,"i32");var h=W(a,"i32");return h===0?(this.gb(),{done:!0}):(this.Ua=new r(h,this.db),this.db.Za[h]=this.Ua,{value:this.Ua,done:!1})}catch(_){throw this.ib=oe(this.eb),this.gb(),_}finally{gt(s)}},n.prototype.gb=function(){Pt(this.Ya),this.Ya=null},n.prototype.getRemainingSQL=function(){return this.ib!==null?this.ib:oe(this.eb)},typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(n.prototype[Symbol.iterator]=function(){return this}),i.prototype.run=function(s,l){if(!this.db)throw"Database closed";if(l){s=this.prepare(s,l);try{s.step()}finally{s.free()}}else this.handleError(w(this.db,s,0,0,a));return this},i.prototype.exec=function(s,l,h){if(!this.db)throw"Database closed";var _=It(),g=null;try{var O=Ee(s),x=Y(4);for(s=[];W(O,"i8")!==0;){pt(a),pt(x),this.handleError(dr(this.db,O,-1,a,x));var H=W(a,"i32");if(O=W(x,"i32"),H!==0){var k=null;for(g=new r(H,this),l!=null&&g.bind(l);g.step();)k===null&&(k={columns:g.getColumnNames(),values:[]},s.push(k)),k.values.push(g.get(null,h));g.free()}}return s}catch(K){throw g&&g.free(),K}finally{gt(_)}},i.prototype.each=function(s,l,h,_,g){typeof l=="function"&&(_=h,h=l,l=void 0),s=this.prepare(s,l);try{for(;s.step();)h(s.getAsObject(null,g))}finally{s.free()}if(typeof _=="function")return _()},i.prototype.prepare=function(s,l){if(pt(a),this.handleError(M(this.db,s,-1,a,0)),s=W(a,"i32"),s===0)throw"Nothing to prepare";var h=new r(s,this);return l!=null&&h.bind(l),this.Za[s]=h},i.prototype.iterateStatements=function(s){return new n(s,this)},i.prototype.export=function(){Object.values(this.Za).forEach(function(l){l.free()}),Object.values(this.Na).forEach(ft),this.Na={},this.handleError(v(this.db));var s=zr(this.filename);return this.handleError(p(this.filename,a)),this.db=W(a,"i32"),br(this.db),s},i.prototype.close=function(){this.db!==null&&(Object.values(this.Za).forEach(function(s){s.free()}),Object.values(this.Na).forEach(ft),this.Na={},this.handleError(v(this.db)),Ye("/"+this.filename),this.db=null)},i.prototype.handleError=function(s){if(s===0)return null;throw s=ln(this.db),Error(s)},i.prototype.getRowsModified=function(){return L(this.db)},i.prototype.create_function=function(s,l){Object.prototype.hasOwnProperty.call(this.Na,s)&&(ft(this.Na[s]),delete this.Na[s]);var h=xt(function(_,g,O){g=e(g,O);try{var x=l.apply(null,g)}catch(H){Qt(_,H,-1);return}t(_,x)},"viii");return this.Na[s]=h,this.handleError(Er(this.db,s,l.length,1,0,h,0,0,0)),this},i.prototype.create_aggregate=function(s,l){var h=l.init||function(){return null},_=l.finalize||function(k){return k},g=l.step;if(!g)throw"An aggregate function must have a step function in "+s;var O={};Object.hasOwnProperty.call(this.Na,s)&&(ft(this.Na[s]),delete this.Na[s]),l=s+"__finalize",Object.hasOwnProperty.call(this.Na,l)&&(ft(this.Na[l]),delete this.Na[l]);var x=xt(function(k,K,ye){var nt=yr(k,1);Object.hasOwnProperty.call(O,nt)||(O[nt]=h()),K=e(K,ye),K=[O[nt]].concat(K);try{O[nt]=g.apply(null,K)}catch(Rn){delete O[nt],Qt(k,Rn,-1)}},"viii"),H=xt(function(k){var K=yr(k,1);try{var ye=_(O[K])}catch(nt){delete O[K],Qt(k,nt,-1);return}t(k,ye),delete O[K]},"vi");return this.Na[s]=x,this.Na[l]=H,this.handleError(Er(this.db,s,g.length-1,1,0,0,x,H,0)),this},o.Database=i};var Nt=Object.assign({},o),zt="./this.program",Te=typeof window=="object",ht=typeof importScripts=="function",At=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",P="",$t,St,Ot;if(At){var Xt=require("fs"),te=require("path");P=ht?te.dirname(P)+"/":__dirname+"/",$t=(t,e)=>(t=Zt(t)?new URL(t):te.normalize(t),Xt.readFileSync(t,e?void 0:"utf8")),Ot=t=>(t=$t(t,!0),t.buffer||(t=new Uint8Array(t)),t),St=(t,e,r,n=!0)=>{t=Zt(t)?new URL(t):te.normalize(t),Xt.readFile(t,n?void 0:"utf8",(i,a)=>{i?r(i):e(n?a.buffer:a)})},!o.thisProgram&&1<process.argv.length&&(zt=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),typeof it<"u"&&(it.exports=o),o.inspect=()=>"[Emscripten Module object]"}else(Te||ht)&&(ht?P=self.location.href:typeof document<"u"&&document.currentScript&&(P=document.currentScript.src),P=P.indexOf("blob:")!==0?P.substr(0,P.replace(/[?#].*/,"").lastIndexOf("/")+1):"",$t=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),e.responseText},ht&&(Ot=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}),St=(t,e,r)=>{var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=()=>{n.status==200||n.status==0&&n.response?e(n.response):r()},n.onerror=r,n.send(null)});var Ie=o.print||console.log.bind(console),$=o.printErr||console.error.bind(console);Object.assign(o,Nt),Nt=null,o.thisProgram&&(zt=o.thisProgram);var ct;o.wasmBinary&&(ct=o.wasmBinary),typeof WebAssembly!="object"&&Q("no native wasm support detected");var Rt,ge=!1,F,S,dt,y,Z,ee,re;function ve(){var t=Rt.buffer;o.HEAP8=F=new Int8Array(t),o.HEAP16=dt=new Int16Array(t),o.HEAPU8=S=new Uint8Array(t),o.HEAPU16=new Uint16Array(t),o.HEAP32=y=new Int32Array(t),o.HEAPU32=Z=new Uint32Array(t),o.HEAPF32=ee=new Float32Array(t),o.HEAPF64=re=new Float64Array(t)}var Ne=[],Ae=[],Se=[];function Hr(){var t=o.preRun.shift();Ne.unshift(t)}var X=0,ne=null,mt=null;function Q(t){throw o.onAbort?.(t),t="Aborted("+t+")",$(t),ge=!0,new WebAssembly.RuntimeError(t+". Build with -sASSERTIONS for more info.")}var Oe=t=>t.startsWith("data:application/octet-stream;base64,"),Zt=t=>t.startsWith("file://"),ot;if(ot="sql-wasm.wasm",!Oe(ot)){var Re=ot;ot=o.locateFile?o.locateFile(Re,P):P+Re}function Ze(t){if(t==ot&&ct)return new Uint8Array(ct);if(Ot)return Ot(t);throw"both async and sync fetching of the wasm failed"}function xr(t){if(!ct&&(Te||ht)){if(typeof fetch=="function"&&!Zt(t))return fetch(t,{credentials:"same-origin"}).then(e=>{if(!e.ok)throw"failed to load wasm binary file at '"+t+"'";return e.arrayBuffer()}).catch(()=>Ze(t));if(St)return new Promise((e,r)=>{St(t,n=>e(new Uint8Array(n)),r)})}return Promise.resolve().then(()=>Ze(t))}function qe(t,e,r){return xr(t).then(n=>WebAssembly.instantiate(n,e)).then(n=>n).then(r,n=>{$(`failed to asynchronously prepare wasm: ${n}`),Q(n)})}function Kr(t,e){var r=ot;ct||typeof WebAssembly.instantiateStreaming!="function"||Oe(r)||Zt(r)||At||typeof fetch!="function"?qe(r,t,e):fetch(r,{credentials:"same-origin"}).then(n=>WebAssembly.instantiateStreaming(n,t).then(e,function(i){return $(`wasm streaming compile failed: ${i}`),$("falling back to ArrayBuffer instantiation"),qe(r,t,e)}))}var m,q,ie=t=>{for(;0<t.length;)t.shift()(o)};function W(t,e="i8"){switch(e.endsWith("*")&&(e="*"),e){case"i1":return F[t>>0];case"i8":return F[t>>0];case"i16":return dt[t>>1];case"i32":return y[t>>2];case"i64":Q("to do getValue(i64) use WASM_BIGINT");case"float":return ee[t>>2];case"double":return re[t>>3];case"*":return Z[t>>2];default:Q(`invalid type for getValue: ${e}`)}}function pt(t){var e="i32";switch(e.endsWith("*")&&(e="*"),e){case"i1":F[t>>0]=0;break;case"i8":F[t>>0]=0;break;case"i16":dt[t>>1]=0;break;case"i32":y[t>>2]=0;break;case"i64":Q("to do setValue(i64) use WASM_BIGINT");case"float":ee[t>>2]=0;break;case"double":re[t>>3]=0;break;case"*":Z[t>>2]=0;break;default:Q(`invalid type for setValue: ${e}`)}}var De=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,D=(t,e,r)=>{var n=e+r;for(r=e;t[r]&&!(r>=n);)++r;if(16<r-e&&t.buffer&&De)return De.decode(t.subarray(e,r));for(n="";e<r;){var i=t[e++];if(i&128){var a=t[e++]&63;if((i&224)==192)n+=String.fromCharCode((i&31)<<6|a);else{var u=t[e++]&63;i=(i&240)==224?(i&15)<<12|a<<6|u:(i&7)<<18|a<<12|u<<6|t[e++]&63,65536>i?n+=String.fromCharCode(i):(i-=65536,n+=String.fromCharCode(55296|i>>10,56320|i&1023))}}else n+=String.fromCharCode(i)}return n},oe=(t,e)=>t?D(S,t,e):"",Le=(t,e)=>{for(var r=0,n=t.length-1;0<=n;n--){var i=t[n];i==="."?t.splice(n,1):i===".."?(t.splice(n,1),r++):r&&(t.splice(n,1),r--)}if(e)for(;r;r--)t.unshift("..");return t},j=t=>{var e=t.charAt(0)==="/",r=t.substr(-1)==="/";return(t=Le(t.split("/").filter(n=>!!n),!e).join("/"))||e||(t="."),t&&r&&(t+="/"),(e?"/":"")+t},Pr=t=>{var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(t).slice(1);return t=e[0],e=e[1],!t&&!e?".":(e&&=e.substr(0,e.length-1),t+e)},qt=t=>{if(t==="/")return"/";t=j(t),t=t.replace(/\/$/,"");var e=t.lastIndexOf("/");return e===-1?t:t.substr(e+1)},Br=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return r=>crypto.getRandomValues(r);if(At)try{var t=require("crypto");if(t.randomFillSync)return r=>t.randomFillSync(r);var e=t.randomBytes;return r=>(r.set(e(r.byteLength)),r)}catch{}Q("initRandomDevice")},Fe=t=>(Fe=Br())(t);function Dt(){for(var t="",e=!1,r=arguments.length-1;-1<=r&&!e;r--){if(e=0<=r?arguments[r]:"/",typeof e!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!e)return"";t=e+"/"+t,e=e.charAt(0)==="/"}return t=Le(t.split("/").filter(n=>!!n),!e).join("/"),(e?"/":"")+t||"."}var se=[],st=t=>{for(var e=0,r=0;r<t.length;++r){var n=t.charCodeAt(r);127>=n?e++:2047>=n?e+=2:55296<=n&&57343>=n?(e+=4,++r):e+=3}return e},at=(t,e,r,n)=>{if(!(0<n))return 0;var i=r;n=r+n-1;for(var a=0;a<t.length;++a){var u=t.charCodeAt(a);if(55296<=u&&57343>=u){var p=t.charCodeAt(++a);u=65536+((u&1023)<<10)|p&1023}if(127>=u){if(r>=n)break;e[r++]=u}else{if(2047>=u){if(r+1>=n)break;e[r++]=192|u>>6}else{if(65535>=u){if(r+2>=n)break;e[r++]=224|u>>12}else{if(r+3>=n)break;e[r++]=240|u>>18,e[r++]=128|u>>12&63}e[r++]=128|u>>6&63}e[r++]=128|u&63}}return e[r]=0,r-i};function Me(t,e){var r=Array(st(t)+1);return t=at(t,r,0,r.length),e&&(r.length=t),r}var Ue=[];function Ce(t,e){Ue[t]={input:[],output:[],Xa:e},fe(t,Qr)}var Qr={open(t){var e=Ue[t.node.rdev];if(!e)throw new f(43);t.tty=e,t.seekable=!1},close(t){t.tty.Xa.fsync(t.tty)},fsync(t){t.tty.Xa.fsync(t.tty)},read(t,e,r,n){if(!t.tty||!t.tty.Xa.sb)throw new f(60);for(var i=0,a=0;a<n;a++){try{var u=t.tty.Xa.sb(t.tty)}catch{throw new f(29)}if(u===void 0&&i===0)throw new f(6);if(u==null)break;i++,e[r+a]=u}return i&&(t.node.timestamp=Date.now()),i},write(t,e,r,n){if(!t.tty||!t.tty.Xa.jb)throw new f(60);try{for(var i=0;i<n;i++)t.tty.Xa.jb(t.tty,e[r+i])}catch{throw new f(29)}return n&&(t.node.timestamp=Date.now()),i}},Wr={sb(){t:{if(!se.length){var t=null;if(At){var e=Buffer.alloc(256),r=0,n=process.stdin.fd;try{r=Xt.readSync(n,e)}catch(i){if(i.toString().includes("EOF"))r=0;else throw i}0<r?t=e.slice(0,r).toString("utf-8"):t=null}else typeof window<"u"&&typeof window.prompt=="function"?(t=window.prompt("Input: "),t!==null&&(t+=`
`)):typeof readline=="function"&&(t=readline(),t!==null&&(t+=`
`));if(!t){t=null;break t}se=Me(t,!0)}t=se.shift()}return t},jb(t,e){e===null||e===10?(Ie(D(t.output,0)),t.output=[]):e!=0&&t.output.push(e)},fsync(t){t.output&&0<t.output.length&&(Ie(D(t.output,0)),t.output=[])},Mb(){return{Ib:25856,Kb:5,Hb:191,Jb:35387,Gb:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},Nb(){return 0},Ob(){return[24,80]}},jr={jb(t,e){e===null||e===10?($(D(t.output,0)),t.output=[]):e!=0&&t.output.push(e)},fsync(t){t.output&&0<t.output.length&&($(D(t.output,0)),t.output=[])}};function ke(t,e){var r=t.Ia?t.Ia.length:0;r>=e||(e=Math.max(e,r*(1048576>r?2:1.125)>>>0),r!=0&&(e=Math.max(e,256)),r=t.Ia,t.Ia=new Uint8Array(e),0<t.Ma&&t.Ia.set(r.subarray(0,t.Ma),0))}var I={Qa:null,Ra(){return I.createNode(null,"/",16895,0)},createNode(t,e,r,n){if((r&61440)===24576||(r&61440)===4096)throw new f(63);return I.Qa||(I.Qa={dir:{node:{Pa:I.Ga.Pa,Oa:I.Ga.Oa,lookup:I.Ga.lookup,ab:I.Ga.ab,rename:I.Ga.rename,unlink:I.Ga.unlink,rmdir:I.Ga.rmdir,readdir:I.Ga.readdir,symlink:I.Ga.symlink},stream:{Ta:I.Ha.Ta}},file:{node:{Pa:I.Ga.Pa,Oa:I.Ga.Oa},stream:{Ta:I.Ha.Ta,read:I.Ha.read,write:I.Ha.write,lb:I.Ha.lb,bb:I.Ha.bb,cb:I.Ha.cb}},link:{node:{Pa:I.Ga.Pa,Oa:I.Ga.Oa,readlink:I.Ga.readlink},stream:{}},pb:{node:{Pa:I.Ga.Pa,Oa:I.Ga.Oa},stream:Yr}}),r=Pe(t,e,r,n),G(r.mode)?(r.Ga=I.Qa.dir.node,r.Ha=I.Qa.dir.stream,r.Ia={}):(r.mode&61440)===32768?(r.Ga=I.Qa.file.node,r.Ha=I.Qa.file.stream,r.Ma=0,r.Ia=null):(r.mode&61440)===40960?(r.Ga=I.Qa.link.node,r.Ha=I.Qa.link.stream):(r.mode&61440)===8192&&(r.Ga=I.Qa.pb.node,r.Ha=I.Qa.pb.stream),r.timestamp=Date.now(),t&&(t.Ia[e]=r,t.timestamp=r.timestamp),r},Lb(t){return t.Ia?t.Ia.subarray?t.Ia.subarray(0,t.Ma):new Uint8Array(t.Ia):new Uint8Array(0)},Ga:{Pa(t){var e={};return e.dev=(t.mode&61440)===8192?t.id:1,e.ino=t.id,e.mode=t.mode,e.nlink=1,e.uid=0,e.gid=0,e.rdev=t.rdev,G(t.mode)?e.size=4096:(t.mode&61440)===32768?e.size=t.Ma:(t.mode&61440)===40960?e.size=t.link.length:e.size=0,e.atime=new Date(t.timestamp),e.mtime=new Date(t.timestamp),e.ctime=new Date(t.timestamp),e.zb=4096,e.blocks=Math.ceil(e.size/e.zb),e},Oa(t,e){if(e.mode!==void 0&&(t.mode=e.mode),e.timestamp!==void 0&&(t.timestamp=e.timestamp),e.size!==void 0&&(e=e.size,t.Ma!=e))if(e==0)t.Ia=null,t.Ma=0;else{var r=t.Ia;t.Ia=new Uint8Array(e),r&&t.Ia.set(r.subarray(0,Math.min(e,t.Ma))),t.Ma=e}},lookup(){throw ue[44]},ab(t,e,r,n){return I.createNode(t,e,r,n)},rename(t,e,r){if(G(t.mode)){try{var n=tt(e,r)}catch{}if(n)for(var i in n.Ia)throw new f(55)}delete t.parent.Ia[t.name],t.parent.timestamp=Date.now(),t.name=r,e.Ia[r]=t,e.timestamp=t.parent.timestamp,t.parent=e},unlink(t,e){delete t.Ia[e],t.timestamp=Date.now()},rmdir(t,e){var r=tt(t,e),n;for(n in r.Ia)throw new f(55);delete t.Ia[e],t.timestamp=Date.now()},readdir(t){var e=[".",".."],r;for(r of Object.keys(t.Ia))e.push(r);return e},symlink(t,e,r){return t=I.createNode(t,e,41471,0),t.link=r,t},readlink(t){if((t.mode&61440)!==40960)throw new f(28);return t.link}},Ha:{read(t,e,r,n,i){var a=t.node.Ia;if(i>=t.node.Ma)return 0;if(t=Math.min(t.node.Ma-i,n),8<t&&a.subarray)e.set(a.subarray(i,i+t),r);else for(n=0;n<t;n++)e[r+n]=a[i+n];return t},write(t,e,r,n,i,a){if(e.buffer===F.buffer&&(a=!1),!n)return 0;if(t=t.node,t.timestamp=Date.now(),e.subarray&&(!t.Ia||t.Ia.subarray)){if(a)return t.Ia=e.subarray(r,r+n),t.Ma=n;if(t.Ma===0&&i===0)return t.Ia=e.slice(r,r+n),t.Ma=n;if(i+n<=t.Ma)return t.Ia.set(e.subarray(r,r+n),i),n}if(ke(t,i+n),t.Ia.subarray&&e.subarray)t.Ia.set(e.subarray(r,r+n),i);else for(a=0;a<n;a++)t.Ia[i+a]=e[r+a];return t.Ma=Math.max(t.Ma,i+n),n},Ta(t,e,r){if(r===1?e+=t.position:r===2&&(t.node.mode&61440)===32768&&(e+=t.node.Ma),0>e)throw new f(28);return e},lb(t,e,r){ke(t.node,e+r),t.node.Ma=Math.max(t.node.Ma,e+r)},bb(t,e,r,n,i){if((t.node.mode&61440)!==32768)throw new f(43);if(t=t.node.Ia,i&2||t.buffer!==F.buffer){if((0<r||r+e<t.length)&&(t.subarray?t=t.subarray(r,r+e):t=Array.prototype.slice.call(t,r,r+e)),r=!0,e=65536*Math.ceil(e/65536),(i=fr(65536,e))?(S.fill(0,i,i+e),e=i):e=0,!e)throw new f(48);F.set(t,e)}else r=!1,e=t.byteOffset;return{Db:e,ub:r}},cb(t,e,r,n){return I.Ha.write(t,e,0,n,r,!1),0}}},Ge=(t,e)=>{var r=0;return t&&(r|=365),e&&(r|=146),r},ae=null,He={},Et=[],Jr=1,V=null,xe=!0,f=null,ue={};function C(t,e={}){if(t=Dt(t),!t)return{path:"",node:null};if(e=Object.assign({qb:!0,kb:0},e),8<e.kb)throw new f(32);t=t.split("/").filter(u=>!!u);for(var r=ae,n="/",i=0;i<t.length;i++){var a=i===t.length-1;if(a&&e.parent)break;if(r=tt(r,t[i]),n=j(n+"/"+t[i]),r.Va&&(!a||a&&e.qb)&&(r=r.Va.root),!a||e.Sa){for(a=0;(r.mode&61440)===40960;)if(r=ze(n),n=Dt(Pr(n),r),r=C(n,{kb:e.kb+1}).node,40<a++)throw new f(32)}}return{path:n,node:r}}function _t(t){for(var e;;){if(t===t.parent)return t=t.Ra.tb,e?t[t.length-1]!=="/"?`${t}/${e}`:t+e:t;e=e?`${t.name}/${e}`:t.name,t=t.parent}}function le(t,e){for(var r=0,n=0;n<e.length;n++)r=(r<<5)-r+e.charCodeAt(n)|0;return(t+r>>>0)%V.length}function Ke(t){var e=le(t.parent.id,t.name);if(V[e]===t)V[e]=t.Wa;else for(e=V[e];e;){if(e.Wa===t){e.Wa=t.Wa;break}e=e.Wa}}function tt(t,e){var r;if(r=(r=ut(t,"x"))?r:t.Ga.lookup?0:2)throw new f(r,t);for(r=V[le(t.id,e)];r;r=r.Wa){var n=r.name;if(r.parent.id===t.id&&n===e)return r}return t.Ga.lookup(t,e)}function Pe(t,e,r,n){return t=new ur(t,e,r,n),e=le(t.parent.id,t.name),t.Wa=V[e],V[e]=t}function G(t){return(t&61440)===16384}function Be(t){var e=["r","w","rw"][t&3];return t&512&&(e+="w"),e}function ut(t,e){if(xe)return 0;if(!e.includes("r")||t.mode&292){if(e.includes("w")&&!(t.mode&146)||e.includes("x")&&!(t.mode&73))return 2}else return 2;return 0}function Qe(t,e){try{return tt(t,e),20}catch{}return ut(t,"wx")}function We(t,e,r){try{var n=tt(t,e)}catch(i){return i.Ka}if(t=ut(t,"wx"))return t;if(r){if(!G(n.mode))return 54;if(n===n.parent||_t(n)==="/")return 10}else if(G(n.mode))return 31;return 0}function Vr(){for(var t=0;4096>=t;t++)if(!Et[t])return t;throw new f(33)}function U(t){if(t=Et[t],!t)throw new f(8);return t}function je(t,e=-1){return wt||(wt=function(){this.$a={}},wt.prototype={},Object.defineProperties(wt.prototype,{object:{get(){return this.node},set(r){this.node=r}},flags:{get(){return this.$a.flags},set(r){this.$a.flags=r}},position:{get(){return this.$a.position},set(r){this.$a.position=r}}})),t=Object.assign(new wt,t),e==-1&&(e=Vr()),t.fd=e,Et[e]=t}var Yr={open(t){t.Ha=He[t.node.rdev].Ha,t.Ha.open?.(t)},Ta(){throw new f(70)}};function fe(t,e){He[t]={Ha:e}}function Je(t,e){var r=e==="/",n=!e;if(r&&ae)throw new f(10);if(!r&&!n){var i=C(e,{qb:!1});if(e=i.path,i=i.node,i.Va)throw new f(10);if(!G(i.mode))throw new f(54)}e={type:t,Pb:{},tb:e,Cb:[]},t=t.Ra(e),t.Ra=e,e.root=t,r?ae=t:i&&(i.Va=e,i.Ra&&i.Ra.Cb.push(e))}function Lt(t,e,r){var n=C(t,{parent:!0}).node;if(t=qt(t),!t||t==="."||t==="..")throw new f(28);var i=Qe(n,t);if(i)throw new f(i);if(!n.Ga.ab)throw new f(63);return n.Ga.ab(n,t,e,r)}function B(t,e){return Lt(t,(e!==void 0?e:511)&1023|16384,0)}function Ft(t,e,r){typeof r>"u"&&(r=e,e=438),Lt(t,e|8192,r)}function he(t,e){if(!Dt(t))throw new f(44);var r=C(e,{parent:!0}).node;if(!r)throw new f(44);e=qt(e);var n=Qe(r,e);if(n)throw new f(n);if(!r.Ga.symlink)throw new f(63);r.Ga.symlink(r,e,t)}function Ve(t){var e=C(t,{parent:!0}).node;t=qt(t);var r=tt(e,t),n=We(e,t,!0);if(n)throw new f(n);if(!e.Ga.rmdir)throw new f(63);if(r.Va)throw new f(10);e.Ga.rmdir(e,t),Ke(r)}function Ye(t){var e=C(t,{parent:!0}).node;if(!e)throw new f(44);t=qt(t);var r=tt(e,t),n=We(e,t,!1);if(n)throw new f(n);if(!e.Ga.unlink)throw new f(63);if(r.Va)throw new f(10);e.Ga.unlink(e,t),Ke(r)}function ze(t){if(t=C(t).node,!t)throw new f(44);if(!t.Ga.readlink)throw new f(28);return Dt(_t(t.parent),t.Ga.readlink(t))}function yt(t,e){if(t=C(t,{Sa:!e}).node,!t)throw new f(44);if(!t.Ga.Pa)throw new f(63);return t.Ga.Pa(t)}function $e(t){return yt(t,!0)}function Mt(t,e){if(t=typeof t=="string"?C(t,{Sa:!0}).node:t,!t.Ga.Oa)throw new f(63);t.Ga.Oa(t,{mode:e&4095|t.mode&-4096,timestamp:Date.now()})}function Xe(t,e){if(0>e)throw new f(28);if(t=typeof t=="string"?C(t,{Sa:!0}).node:t,!t.Ga.Oa)throw new f(63);if(G(t.mode))throw new f(31);if((t.mode&61440)!==32768)throw new f(28);var r=ut(t,"w");if(r)throw new f(r);t.Ga.Oa(t,{size:e,timestamp:Date.now()})}function lt(t,e,r){if(t==="")throw new f(44);if(typeof e=="string"){var n={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[e];if(typeof n>"u")throw Error(`Unknown file open mode: ${e}`);e=n}if(r=e&64?(typeof r>"u"?438:r)&4095|32768:0,typeof t=="object")var i=t;else{t=j(t);try{i=C(t,{Sa:!(e&131072)}).node}catch{}}if(n=!1,e&64)if(i){if(e&128)throw new f(20)}else i=Lt(t,r,0),n=!0;if(!i)throw new f(44);if((i.mode&61440)===8192&&(e&=-513),e&65536&&!G(i.mode))throw new f(54);if(!n&&(r=i?(i.mode&61440)===40960?32:G(i.mode)&&(Be(e)!=="r"||e&512)?31:ut(i,Be(e)):44))throw new f(r);return e&512&&!n&&Xe(i,0),e&=-131713,i=je({node:i,path:_t(i),flags:e,seekable:!0,position:0,Ha:i.Ha,Fb:[],error:!1}),i.Ha.open&&i.Ha.open(i),!o.logReadFiles||e&1||(de||={},t in de||(de[t]=1)),i}function ce(t){if(t.fd===null)throw new f(8);t.hb&&(t.hb=null);try{t.Ha.close&&t.Ha.close(t)}catch(e){throw e}finally{Et[t.fd]=null}t.fd=null}function tr(t,e,r){if(t.fd===null)throw new f(8);if(!t.seekable||!t.Ha.Ta)throw new f(70);if(r!=0&&r!=1&&r!=2)throw new f(28);t.position=t.Ha.Ta(t,e,r),t.Fb=[]}function er(t,e,r,n,i){if(0>n||0>i)throw new f(28);if(t.fd===null)throw new f(8);if((t.flags&2097155)===1)throw new f(8);if(G(t.node.mode))throw new f(31);if(!t.Ha.read)throw new f(28);var a=typeof i<"u";if(!a)i=t.position;else if(!t.seekable)throw new f(70);return e=t.Ha.read(t,e,r,n,i),a||(t.position+=e),e}function rr(t,e,r,n,i){if(0>n||0>i)throw new f(28);if(t.fd===null)throw new f(8);if(!(t.flags&2097155))throw new f(8);if(G(t.node.mode))throw new f(31);if(!t.Ha.write)throw new f(28);t.seekable&&t.flags&1024&&tr(t,0,2);var a=typeof i<"u";if(!a)i=t.position;else if(!t.seekable)throw new f(70);return e=t.Ha.write(t,e,r,n,i,void 0),a||(t.position+=e),e}function zr(t){var e="binary";if(e!=="utf8"&&e!=="binary")throw Error(`Invalid encoding type "${e}"`);var r,n=lt(t,n||0);t=yt(t).size;var i=new Uint8Array(t);return er(n,i,0,t,0),e==="utf8"?r=D(i,0):e==="binary"&&(r=i),ce(n),r}function nr(){f||(f=function(t,e){this.name="ErrnoError",this.node=e,this.Eb=function(r){this.Ka=r},this.Eb(t),this.message="FS error"},f.prototype=Error(),f.prototype.constructor=f,[44].forEach(t=>{ue[t]=new f(t),ue[t].stack="<generic error, no stack>"}))}var ir;function bt(t,e,r){t=j("/dev/"+t);var n=Ge(!!e,!!r);or||=64;var i=or++<<8|0;fe(i,{open(a){a.seekable=!1},close(){r?.buffer?.length&&r(10)},read(a,u,p,v){for(var w=0,L=0;L<v;L++){try{var M=e()}catch{throw new f(29)}if(M===void 0&&w===0)throw new f(6);if(M==null)break;w++,u[p+L]=M}return w&&(a.node.timestamp=Date.now()),w},write(a,u,p,v){for(var w=0;w<v;w++)try{r(u[p+w])}catch{throw new f(29)}return v&&(a.node.timestamp=Date.now()),w}}),Ft(t,n,i)}var or,R={},wt,de;function et(t,e,r){if(e.charAt(0)==="/")return e;if(t=t===-100?"/":U(t).path,e.length==0){if(!r)throw new f(44);return t}return j(t+"/"+e)}function Ut(t,e,r){try{var n=t(e)}catch(a){if(a&&a.node&&j(e)!==j(_t(a.node)))return-54;throw a}y[r>>2]=n.dev,y[r+4>>2]=n.mode,Z[r+8>>2]=n.nlink,y[r+12>>2]=n.uid,y[r+16>>2]=n.gid,y[r+20>>2]=n.rdev,q=[n.size>>>0,(m=n.size,1<=+Math.abs(m)?0<m?+Math.floor(m/4294967296)>>>0:~~+Math.ceil((m-+(~~m>>>0))/4294967296)>>>0:0)],y[r+24>>2]=q[0],y[r+28>>2]=q[1],y[r+32>>2]=4096,y[r+36>>2]=n.blocks,t=n.atime.getTime(),e=n.mtime.getTime();var i=n.ctime.getTime();return q=[Math.floor(t/1e3)>>>0,(m=Math.floor(t/1e3),1<=+Math.abs(m)?0<m?+Math.floor(m/4294967296)>>>0:~~+Math.ceil((m-+(~~m>>>0))/4294967296)>>>0:0)],y[r+40>>2]=q[0],y[r+44>>2]=q[1],Z[r+48>>2]=t%1e3*1e3,q=[Math.floor(e/1e3)>>>0,(m=Math.floor(e/1e3),1<=+Math.abs(m)?0<m?+Math.floor(m/4294967296)>>>0:~~+Math.ceil((m-+(~~m>>>0))/4294967296)>>>0:0)],y[r+56>>2]=q[0],y[r+60>>2]=q[1],Z[r+64>>2]=e%1e3*1e3,q=[Math.floor(i/1e3)>>>0,(m=Math.floor(i/1e3),1<=+Math.abs(m)?0<m?+Math.floor(m/4294967296)>>>0:~~+Math.ceil((m-+(~~m>>>0))/4294967296)>>>0:0)],y[r+72>>2]=q[0],y[r+76>>2]=q[1],Z[r+80>>2]=i%1e3*1e3,q=[n.ino>>>0,(m=n.ino,1<=+Math.abs(m)?0<m?+Math.floor(m/4294967296)>>>0:~~+Math.ceil((m-+(~~m>>>0))/4294967296)>>>0:0)],y[r+88>>2]=q[0],y[r+92>>2]=q[1],0}var Ct=void 0;function kt(){var t=y[+Ct>>2];return Ct+=4,t}var Tt=(t,e)=>e+2097152>>>0<4194305-!!t?(t>>>0)+4294967296*e:NaN,$r=[0,31,60,91,121,152,182,213,244,274,305,335],Xr=[0,31,59,90,120,151,181,212,243,273,304,334],sr=t=>{var e=st(t)+1,r=Kt(e);return r&&at(t,S,r,e),r},me={},ar=()=>{if(!pe){var t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:zt||"./this.program"},e;for(e in me)me[e]===void 0?delete t[e]:t[e]=me[e];var r=[];for(e in t)r.push(`${e}=${t[e]}`);pe=r}return pe},pe,Ee=t=>{var e=st(t)+1,r=Y(e);return at(t,S,r,e),r},tn=(t,e,r,n)=>{var i={string:w=>{var L=0;return w!=null&&w!==0&&(L=Ee(w)),L},array:w=>{var L=Y(w.length);return F.set(w,L),L}};t=o["_"+t];var a=[],u=0;if(n)for(var p=0;p<n.length;p++){var v=i[r[p]];v?(u===0&&(u=It()),a[p]=v(n[p])):a[p]=n[p]}return r=t.apply(null,a),r=function(w){return u!==0&&gt(u),e==="string"?w?D(S,w):"":e==="boolean"?!!w:w}(r)},Gt=0,Ht=(t,e)=>(e=e==1?Y(t.length):Kt(t.length),t.subarray||t.slice||(t=new Uint8Array(t)),S.set(t,e),e),rt,_e=[],J,ft=t=>{rt.delete(J.get(t)),J.set(t,null),_e.push(t)},xt=(t,e)=>{if(!rt){rt=new WeakMap;var r=J.length;if(rt)for(var n=0;n<0+r;n++){var i=J.get(n);i&&rt.set(i,n)}}if(r=rt.get(t)||0)return r;if(_e.length)r=_e.pop();else{try{J.grow(1)}catch(p){throw p instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":p}r=J.length-1}try{J.set(r,t)}catch(p){if(!(p instanceof TypeError))throw p;if(typeof WebAssembly.Function=="function"){n=WebAssembly.Function,i={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"};for(var a={parameters:[],results:e[0]=="v"?[]:[i[e[0]]]},u=1;u<e.length;++u)a.parameters.push(i[e[u]]);e=new n(a,t)}else{for(n=[1],i=e.slice(0,1),e=e.slice(1),a={i:127,p:127,j:126,f:125,d:124,e:111},n.push(96),u=e.length,128>u?n.push(u):n.push(u%128|128,u>>7),u=0;u<e.length;++u)n.push(a[e[u]]);i=="v"?n.push(0):n.push(1,a[i]),e=[0,97,115,109,1,0,0,0,1],i=n.length,128>i?e.push(i):e.push(i%128|128,i>>7),e.push.apply(e,n),e.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),e=new WebAssembly.Module(new Uint8Array(e)),e=new WebAssembly.Instance(e,{e:{f:t}}).exports.f}J.set(r,e)}return rt.set(t,r),r};function ur(t,e,r,n){t||=this,this.parent=t,this.Ra=t.Ra,this.Va=null,this.id=Jr++,this.name=e,this.mode=r,this.Ga={},this.Ha={},this.rdev=n}Object.defineProperties(ur.prototype,{read:{get:function(){return(this.mode&365)===365},set:function(t){t?this.mode|=365:this.mode&=-366}},write:{get:function(){return(this.mode&146)===146},set:function(t){t?this.mode|=146:this.mode&=-147}}}),nr(),V=Array(4096),Je(I,"/"),B("/tmp"),B("/home"),B("/home/web_user"),function(){B("/dev"),fe(259,{read:()=>0,write:(n,i,a,u)=>u}),Ft("/dev/null",259),Ce(1280,Wr),Ce(1536,jr),Ft("/dev/tty",1280),Ft("/dev/tty1",1536);var t=new Uint8Array(1024),e=0,r=()=>(e===0&&(e=Fe(t).byteLength),t[--e]);bt("random",r),bt("urandom",r),B("/dev/shm"),B("/dev/shm/tmp")}(),function(){B("/proc");var t=B("/proc/self");B("/proc/self/fd"),Je({Ra(){var e=Pe(t,"fd",16895,73);return e.Ga={lookup(r,n){var i=U(+n);return r={parent:null,Ra:{tb:"fake"},Ga:{readlink:()=>i.path}},r.parent=r}},e}},"/proc/self/fd")}();var en={a:(t,e,r,n)=>{Q(`Assertion failed: ${t?D(S,t):""}, at: `+[e?e?D(S,e):"":"unknown filename",r,n?n?D(S,n):"":"unknown function"])},h:function(t,e){try{return t=t?D(S,t):"",Mt(t,e),0}catch(r){if(typeof R>"u"||r.name!=="ErrnoError")throw r;return-r.Ka}},H:function(t,e,r){try{if(e=e?D(S,e):"",e=et(t,e),r&-8)return-28;var n=C(e,{Sa:!0}).node;return n?(t="",r&4&&(t+="r"),r&2&&(t+="w"),r&1&&(t+="x"),t&&ut(n,t)?-2:0):-44}catch(i){if(typeof R>"u"||i.name!=="ErrnoError")throw i;return-i.Ka}},i:function(t,e){try{var r=U(t);return Mt(r.node,e),0}catch(n){if(typeof R>"u"||n.name!=="ErrnoError")throw n;return-n.Ka}},g:function(t){try{var e=U(t).node,r=typeof e=="string"?C(e,{Sa:!0}).node:e;if(!r.Ga.Oa)throw new f(63);return r.Ga.Oa(r,{timestamp:Date.now()}),0}catch(n){if(typeof R>"u"||n.name!=="ErrnoError")throw n;return-n.Ka}},b:function(t,e,r){Ct=r;try{var n=U(t);switch(e){case 0:var i=kt();if(0>i)return-28;for(;Et[i];)i++;return je(n,i).fd;case 1:case 2:return 0;case 3:return n.flags;case 4:return i=kt(),n.flags|=i,0;case 5:return i=kt(),dt[i+0>>1]=2,0;case 6:case 7:return 0;case 16:case 8:return-28;case 9:return y[lr()>>2]=28,-1;default:return-28}}catch(a){if(typeof R>"u"||a.name!=="ErrnoError")throw a;return-a.Ka}},f:function(t,e){try{var r=U(t);return Ut(yt,r.path,e)}catch(n){if(typeof R>"u"||n.name!=="ErrnoError")throw n;return-n.Ka}},n:function(t,e,r){e=Tt(e,r);try{if(isNaN(e))return 61;var n=U(t);if(!(n.flags&2097155))throw new f(28);return Xe(n.node,e),0}catch(i){if(typeof R>"u"||i.name!=="ErrnoError")throw i;return-i.Ka}},C:function(t,e){try{if(e===0)return-28;var r=st("/")+1;return e<r?-68:(at("/",S,t,e),r)}catch(n){if(typeof R>"u"||n.name!=="ErrnoError")throw n;return-n.Ka}},F:function(t,e){try{return t=t?D(S,t):"",Ut($e,t,e)}catch(r){if(typeof R>"u"||r.name!=="ErrnoError")throw r;return-r.Ka}},z:function(t,e,r){try{return e=e?D(S,e):"",e=et(t,e),e=j(e),e[e.length-1]==="/"&&(e=e.substr(0,e.length-1)),B(e,r),0}catch(n){if(typeof R>"u"||n.name!=="ErrnoError")throw n;return-n.Ka}},E:function(t,e,r,n){try{e=e?D(S,e):"";var i=n&256;return e=et(t,e,n&4096),Ut(i?$e:yt,e,r)}catch(a){if(typeof R>"u"||a.name!=="ErrnoError")throw a;return-a.Ka}},y:function(t,e,r,n){Ct=n;try{e=e?D(S,e):"",e=et(t,e);var i=n?kt():0;return lt(e,r,i).fd}catch(a){if(typeof R>"u"||a.name!=="ErrnoError")throw a;return-a.Ka}},w:function(t,e,r,n){try{if(e=e?D(S,e):"",e=et(t,e),0>=n)return-28;var i=ze(e),a=Math.min(n,st(i)),u=F[r+a];return at(i,S,r,n+1),F[r+a]=u,a}catch(p){if(typeof R>"u"||p.name!=="ErrnoError")throw p;return-p.Ka}},v:function(t){try{return t=t?D(S,t):"",Ve(t),0}catch(e){if(typeof R>"u"||e.name!=="ErrnoError")throw e;return-e.Ka}},G:function(t,e){try{return t=t?D(S,t):"",Ut(yt,t,e)}catch(r){if(typeof R>"u"||r.name!=="ErrnoError")throw r;return-r.Ka}},r:function(t,e,r){try{return e=e?D(S,e):"",e=et(t,e),r===0?Ye(e):r===512?Ve(e):Q("Invalid flags passed to unlinkat"),0}catch(n){if(typeof R>"u"||n.name!=="ErrnoError")throw n;return-n.Ka}},q:function(t,e,r){try{if(e=e?D(S,e):"",e=et(t,e,!0),r){var n=Z[r>>2]+4294967296*y[r+4>>2],i=y[r+8>>2];a=1e3*n+i/1e6,r+=16,n=Z[r>>2]+4294967296*y[r+4>>2],i=y[r+8>>2],u=1e3*n+i/1e6}else var a=Date.now(),u=a;t=a;var p=C(e,{Sa:!0}).node;return p.Ga.Oa(p,{timestamp:Math.max(t,u)}),0}catch(v){if(typeof R>"u"||v.name!=="ErrnoError")throw v;return-v.Ka}},l:function(t,e,r){t=new Date(1e3*Tt(t,e)),y[r>>2]=t.getSeconds(),y[r+4>>2]=t.getMinutes(),y[r+8>>2]=t.getHours(),y[r+12>>2]=t.getDate(),y[r+16>>2]=t.getMonth(),y[r+20>>2]=t.getFullYear()-1900,y[r+24>>2]=t.getDay(),e=t.getFullYear(),y[r+28>>2]=(e%4!==0||e%100===0&&e%400!==0?Xr:$r)[t.getMonth()]+t.getDate()-1|0,y[r+36>>2]=-(60*t.getTimezoneOffset()),e=new Date(t.getFullYear(),6,1).getTimezoneOffset();var n=new Date(t.getFullYear(),0,1).getTimezoneOffset();y[r+32>>2]=(e!=n&&t.getTimezoneOffset()==Math.min(n,e))|0},j:function(t,e,r,n,i,a,u,p){i=Tt(i,a);try{if(isNaN(i))return 61;var v=U(n);if(e&2&&!(r&2)&&(v.flags&2097155)!==2)throw new f(2);if((v.flags&2097155)===1)throw new f(2);if(!v.Ha.bb)throw new f(43);var w=v.Ha.bb(v,t,i,e,r),L=w.Db;return y[u>>2]=w.ub,Z[p>>2]=L,0}catch(M){if(typeof R>"u"||M.name!=="ErrnoError")throw M;return-M.Ka}},k:function(t,e,r,n,i,a,u){a=Tt(a,u);try{if(isNaN(a))return 61;var p=U(i);if(r&2){if((p.node.mode&61440)!==32768)throw new f(43);if(!(n&2)){var v=S.slice(t,t+e);p.Ha.cb&&p.Ha.cb(p,v,a,e,n)}}}catch(w){if(typeof R>"u"||w.name!=="ErrnoError")throw w;return-w.Ka}},s:(t,e,r)=>{function n(v){return(v=v.toTimeString().match(/\(([A-Za-z ]+)\)$/))?v[1]:"GMT"}var i=new Date().getFullYear(),a=new Date(i,0,1),u=new Date(i,6,1);i=a.getTimezoneOffset();var p=u.getTimezoneOffset();Z[t>>2]=60*Math.max(i,p),y[e>>2]=+(i!=p),t=n(a),e=n(u),t=sr(t),e=sr(e),p<i?(Z[r>>2]=t,Z[r+4>>2]=e):(Z[r>>2]=e,Z[r+4>>2]=t)},d:()=>Date.now(),t:()=>2147483648,c:()=>performance.now(),o:t=>{var e=S.length;if(t>>>=0,2147483648<t)return!1;for(var r=1;4>=r;r*=2){var n=e*(1+.2/r);n=Math.min(n,t+100663296);var i=Math;n=Math.max(t,n);t:{i=(i.min.call(i,2147483648,n+(65536-n%65536)%65536)-Rt.buffer.byteLength+65535)/65536;try{Rt.grow(i),ve();var a=1;break t}catch{}a=void 0}if(a)return!0}return!1},A:(t,e)=>{var r=0;return ar().forEach((n,i)=>{var a=e+r;for(i=Z[t+4*i>>2]=a,a=0;a<n.length;++a)F[i++>>0]=n.charCodeAt(a);F[i>>0]=0,r+=n.length+1}),0},B:(t,e)=>{var r=ar();Z[t>>2]=r.length;var n=0;return r.forEach(i=>n+=i.length+1),Z[e>>2]=n,0},e:function(t){try{var e=U(t);return ce(e),0}catch(r){if(typeof R>"u"||r.name!=="ErrnoError")throw r;return r.Ka}},p:function(t,e){try{var r=U(t);return F[e>>0]=r.tty?2:G(r.mode)?3:(r.mode&61440)===40960?7:4,dt[e+2>>1]=0,q=[0,(m=0,1<=+Math.abs(m)?0<m?+Math.floor(m/4294967296)>>>0:~~+Math.ceil((m-+(~~m>>>0))/4294967296)>>>0:0)],y[e+8>>2]=q[0],y[e+12>>2]=q[1],q=[0,(m=0,1<=+Math.abs(m)?0<m?+Math.floor(m/4294967296)>>>0:~~+Math.ceil((m-+(~~m>>>0))/4294967296)>>>0:0)],y[e+16>>2]=q[0],y[e+20>>2]=q[1],0}catch(n){if(typeof R>"u"||n.name!=="ErrnoError")throw n;return n.Ka}},x:function(t,e,r,n){try{t:{var i=U(t);t=e;for(var a,u=e=0;u<r;u++){var p=Z[t>>2],v=Z[t+4>>2];t+=8;var w=er(i,F,p,v,a);if(0>w){var L=-1;break t}if(e+=w,w<v)break;typeof a<"u"&&(a+=w)}L=e}return Z[n>>2]=L,0}catch(M){if(typeof R>"u"||M.name!=="ErrnoError")throw M;return M.Ka}},m:function(t,e,r,n,i){e=Tt(e,r);try{if(isNaN(e))return 61;var a=U(t);return tr(a,e,n),q=[a.position>>>0,(m=a.position,1<=+Math.abs(m)?0<m?+Math.floor(m/4294967296)>>>0:~~+Math.ceil((m-+(~~m>>>0))/4294967296)>>>0:0)],y[i>>2]=q[0],y[i+4>>2]=q[1],a.hb&&e===0&&n===0&&(a.hb=null),0}catch(u){if(typeof R>"u"||u.name!=="ErrnoError")throw u;return u.Ka}},D:function(t){try{var e=U(t);return e.Ha?.fsync?e.Ha.fsync(e):0}catch(r){if(typeof R>"u"||r.name!=="ErrnoError")throw r;return r.Ka}},u:function(t,e,r,n){try{t:{var i=U(t);t=e;for(var a,u=e=0;u<r;u++){var p=Z[t>>2],v=Z[t+4>>2];t+=8;var w=rr(i,F,p,v,a);if(0>w){var L=-1;break t}e+=w,typeof a<"u"&&(a+=w)}L=e}return Z[n>>2]=L,0}catch(M){if(typeof R>"u"||M.name!=="ErrnoError")throw M;return M.Ka}}},c=function(){function t(r){return c=r.exports,Rt=c.I,ve(),J=c.Aa,Ae.unshift(c.J),X--,o.monitorRunDependencies?.(X),X==0&&(ne!==null&&(clearInterval(ne),ne=null),mt&&(r=mt,mt=null,r())),c}var e={a:en};if(X++,o.monitorRunDependencies?.(X),o.instantiateWasm)try{return o.instantiateWasm(e,t)}catch(r){return $(`Module.instantiateWasm callback failed with error: ${r}`),!1}return Kr(e,function(r){t(r.instance)}),{}}();o._sqlite3_free=t=>(o._sqlite3_free=c.K)(t),o._sqlite3_value_text=t=>(o._sqlite3_value_text=c.L)(t);var lr=()=>(lr=c.M)();o._sqlite3_prepare_v2=(t,e,r,n,i)=>(o._sqlite3_prepare_v2=c.N)(t,e,r,n,i),o._sqlite3_step=t=>(o._sqlite3_step=c.O)(t),o._sqlite3_reset=t=>(o._sqlite3_reset=c.P)(t),o._sqlite3_exec=(t,e,r,n,i)=>(o._sqlite3_exec=c.Q)(t,e,r,n,i),o._sqlite3_finalize=t=>(o._sqlite3_finalize=c.R)(t),o._sqlite3_column_name=(t,e)=>(o._sqlite3_column_name=c.S)(t,e),o._sqlite3_column_text=(t,e)=>(o._sqlite3_column_text=c.T)(t,e),o._sqlite3_column_type=(t,e)=>(o._sqlite3_column_type=c.U)(t,e),o._sqlite3_errmsg=t=>(o._sqlite3_errmsg=c.V)(t),o._sqlite3_clear_bindings=t=>(o._sqlite3_clear_bindings=c.W)(t),o._sqlite3_value_blob=t=>(o._sqlite3_value_blob=c.X)(t),o._sqlite3_value_bytes=t=>(o._sqlite3_value_bytes=c.Y)(t),o._sqlite3_value_double=t=>(o._sqlite3_value_double=c.Z)(t),o._sqlite3_value_int=t=>(o._sqlite3_value_int=c._)(t),o._sqlite3_value_type=t=>(o._sqlite3_value_type=c.$)(t),o._sqlite3_result_blob=(t,e,r,n)=>(o._sqlite3_result_blob=c.aa)(t,e,r,n),o._sqlite3_result_double=(t,e)=>(o._sqlite3_result_double=c.ba)(t,e),o._sqlite3_result_error=(t,e,r)=>(o._sqlite3_result_error=c.ca)(t,e,r),o._sqlite3_result_int=(t,e)=>(o._sqlite3_result_int=c.da)(t,e),o._sqlite3_result_int64=(t,e,r)=>(o._sqlite3_result_int64=c.ea)(t,e,r),o._sqlite3_result_null=t=>(o._sqlite3_result_null=c.fa)(t),o._sqlite3_result_text=(t,e,r,n)=>(o._sqlite3_result_text=c.ga)(t,e,r,n),o._sqlite3_aggregate_context=(t,e)=>(o._sqlite3_aggregate_context=c.ha)(t,e),o._sqlite3_column_count=t=>(o._sqlite3_column_count=c.ia)(t),o._sqlite3_data_count=t=>(o._sqlite3_data_count=c.ja)(t),o._sqlite3_column_blob=(t,e)=>(o._sqlite3_column_blob=c.ka)(t,e),o._sqlite3_column_bytes=(t,e)=>(o._sqlite3_column_bytes=c.la)(t,e),o._sqlite3_column_double=(t,e)=>(o._sqlite3_column_double=c.ma)(t,e),o._sqlite3_bind_blob=(t,e,r,n,i)=>(o._sqlite3_bind_blob=c.na)(t,e,r,n,i),o._sqlite3_bind_double=(t,e,r)=>(o._sqlite3_bind_double=c.oa)(t,e,r),o._sqlite3_bind_int=(t,e,r)=>(o._sqlite3_bind_int=c.pa)(t,e,r),o._sqlite3_bind_text=(t,e,r,n,i)=>(o._sqlite3_bind_text=c.qa)(t,e,r,n,i),o._sqlite3_bind_parameter_index=(t,e)=>(o._sqlite3_bind_parameter_index=c.ra)(t,e),o._sqlite3_sql=t=>(o._sqlite3_sql=c.sa)(t),o._sqlite3_normalized_sql=t=>(o._sqlite3_normalized_sql=c.ta)(t),o._sqlite3_changes=t=>(o._sqlite3_changes=c.ua)(t),o._sqlite3_close_v2=t=>(o._sqlite3_close_v2=c.va)(t),o._sqlite3_create_function_v2=(t,e,r,n,i,a,u,p,v)=>(o._sqlite3_create_function_v2=c.wa)(t,e,r,n,i,a,u,p,v),o._sqlite3_open=(t,e)=>(o._sqlite3_open=c.xa)(t,e);var Kt=o._malloc=t=>(Kt=o._malloc=c.ya)(t),Pt=o._free=t=>(Pt=o._free=c.za)(t);o._RegisterExtensionFunctions=t=>(o._RegisterExtensionFunctions=c.Ba)(t);var fr=(t,e)=>(fr=c.Ca)(t,e),It=()=>(It=c.Da)(),gt=t=>(gt=c.Ea)(t),Y=t=>(Y=c.Fa)(t);o.stackAlloc=Y,o.stackSave=It,o.stackRestore=gt,o.cwrap=(t,e,r,n)=>{var i=!r||r.every(a=>a==="number"||a==="boolean");return e!=="string"&&i&&!n?o["_"+t]:function(){return tn(t,e,r,arguments)}},o.addFunction=xt,o.removeFunction=ft,o.UTF8ToString=oe,o.ALLOC_NORMAL=Gt,o.allocate=Ht,o.allocateUTF8OnStack=Ee;var Bt;mt=function t(){Bt||hr(),Bt||(mt=t)};function hr(){function t(){if(!Bt&&(Bt=!0,o.calledRun=!0,!ge)){if(o.noFSInit||ir||(ir=!0,nr(),o.stdin=o.stdin,o.stdout=o.stdout,o.stderr=o.stderr,o.stdin?bt("stdin",o.stdin):he("/dev/tty","/dev/stdin"),o.stdout?bt("stdout",null,o.stdout):he("/dev/tty","/dev/stdout"),o.stderr?bt("stderr",null,o.stderr):he("/dev/tty1","/dev/stderr"),lt("/dev/stdin",0),lt("/dev/stdout",1),lt("/dev/stderr",1)),xe=!1,ie(Ae),o.onRuntimeInitialized&&o.onRuntimeInitialized(),o.postRun)for(typeof o.postRun=="function"&&(o.postRun=[o.postRun]);o.postRun.length;){var e=o.postRun.shift();Se.unshift(e)}ie(Se)}}if(!(0<X)){if(o.preRun)for(typeof o.preRun=="function"&&(o.preRun=[o.preRun]);o.preRun.length;)Hr();ie(Ne),0<X||(o.setStatus?(o.setStatus("Running..."),setTimeout(function(){setTimeout(function(){o.setStatus("")},1),t()},1)):t())}}if(o.preInit)for(typeof o.preInit=="function"&&(o.preInit=[o.preInit]);0<o.preInit.length;)o.preInit.pop()();return hr(),T}),jt)};typeof Vt=="object"&&typeof it=="object"?(it.exports=Jt,it.exports.default=Jt):typeof define=="function"&&define.amd?define([],function(){return Jt}):typeof Vt=="object"&&(Vt.Module=Jt)});var Hn={};Un(Hn,{default:()=>Gr});module.exports=Cn(Hn);var N=require("@raycast/api"),Yt=require("react");var vt=require("react");var Lr=require("@raycast/api"),be=require("fs"),Fr=require("os"),Mr=Tr(require("path")),Ur=Tr(Ir());var gr=`
SELECT
  notes.ZUNIQUEIDENTIFIER AS id,
  notes.ZTITLE AS title,
  notes.ZTEXT AS text,
  notes.ZMODIFICATIONDATE AS modified_at,
  notes.ZCREATIONDATE AS created_at,
  group_concat(tags.ZTITLE) AS tags,
  notes.ZENCRYPTED AS encrypted
FROM
  ZSFNOTE AS notes
LEFT OUTER JOIN
  Z_7TAGS AS notes_to_tags ON notes.Z_PK = notes_to_tags.Z_7NOTES
LEFT OUTER JOIN
  ZSFNOTETAG AS tags ON notes_to_tags.Z_14TAGS = tags.Z_PK
WHERE
  -- When there is a query, filter the body by that query, otherwise
  -- ignore the query
  (
    lower(notes.ZTITLE) LIKE lower('%' || :query || '%')
    OR lower(notes.ZTEXT) LIKE lower('%' || :query || '%')
    OR :query = ''
    OR lower(notes.ZUNIQUEIDENTIFIER) LIKE lower('%' || :query || '%')
  )
  -- Ignore trashed, archived, and empty notes
  AND notes.ZARCHIVED = 0
  AND notes.ZTRASHED = 0
  AND (
    notes.ZTEXT IS NOT NULL
    OR notes.ZENCRYPTED = 1
  )
GROUP BY
  notes.ZUNIQUEIDENTIFIER
HAVING
  (:tag IS NULL OR group_concat('#' || tags.ZTITLE || '#') LIKE '%#' || :tag || '#%')
ORDER BY
  -- Sort title matches ahead of body matches
  CASE WHEN (
    lower(notes.ZTITLE) like lower('%' || :query || '%')
    OR :query = ''
  ) THEN 0 ELSE 1 END,
  -- When there are multiple title matches, sort by last modified
  notes.ZMODIFICATIONDATE DESC
LIMIT
  20
`,vr=`
SELECT
  notes.ZUNIQUEIDENTIFIER AS id,
  notes.ZTITLE AS title,
  notes.ZTEXT AS text,
  notes.ZMODIFICATIONDATE AS modified_at,
  notes.ZCREATIONDATE AS created_at,
  group_concat(tags.ZTITLE) AS tags,
  notes.ZENCRYPTED AS encrypted,
  notes.ZPINNED AS pinned
FROM
  ZSFNOTE AS notes
LEFT OUTER JOIN
  Z_5TAGS AS notes_to_tags ON notes.Z_PK = notes_to_tags.Z_5NOTES
LEFT OUTER JOIN
  ZSFNOTETAG AS tags ON notes_to_tags.Z_13TAGS = tags.Z_PK
WHERE
  -- When there is a query, filter the body by that query, otherwise
  -- ignore the query
  (
    lower(notes.ZTITLE) LIKE lower('%' || :query || '%')
    OR lower(notes.ZTEXT) LIKE lower('%' || :query || '%')
    OR :query = ''
    OR lower(notes.ZUNIQUEIDENTIFIER) LIKE lower('%' || :query || '%')
  )
  -- Ignore trashed, archived, and empty notes
  AND notes.ZARCHIVED = 0
  AND notes.ZTRASHED = 0
  AND (
    notes.ZTEXT IS NOT NULL
    OR notes.ZENCRYPTED = 1
  )
GROUP BY
  notes.ZUNIQUEIDENTIFIER
HAVING
  (:tag IS NULL OR group_concat('#' || tags.ZTITLE || '#') LIKE '%#' || :tag || '#%')
ORDER BY
  -- Sort title matches ahead of body matches
  CASE WHEN (
    lower(notes.ZTITLE) like lower('%' || :query || '%')
    OR :query = ''
  ) THEN 0 ELSE 1 END,
  -- When there are multiple title matches, sort by last modified
  notes.ZMODIFICATIONDATE DESC
LIMIT
  20
`,Nr=`
  SELECT DISTINCT
  note.ZUNIQUEIDENTIFIER AS id,
  note.ZTITLE AS title,
  note.ZTEXT AS text,
  note.ZMODIFICATIONDATE AS modified_at,
  group_concat(tag.ZTITLE) AS tags
FROM
	ZSFNOTE note
	LEFT OUTER JOIN Z_7TAGS nTag ON note.Z_PK = nTag.Z_7NOTES
	LEFT OUTER JOIN ZSFNOTETAG tag ON nTag.Z_14TAGS = tag.Z_PK
WHERE
	note.ZUNIQUEIDENTIFIER in(
		SELECT
			src.ZUNIQUEIDENTIFIER FROM ZSFNOTE src
			JOIN Z_7LINKEDNOTES lnk ON lnk.Z_7LINKEDBYNOTES = src.Z_PK
			JOIN ZSFNOTE trgt ON lnk.Z_7LINKEDNOTES = trgt.Z_PK
		WHERE
			trgt.ZUNIQUEIDENTIFIER LIKE :id )
GROUP BY
	note.ZUNIQUEIDENTIFIER
ORDER BY
	note.ZMODIFICATIONDATE DESC
LIMIT 400
`,Ar=`
SELECT DISTINCT
	note.ZUNIQUEIDENTIFIER AS id,
	note.ZTITLE AS title,
	note.ZTEXT AS text,
	note.ZMODIFICATIONDATE AS modified_at,
	group_concat(tag.ZTITLE) AS tags
FROM
	ZSFNOTE note
	LEFT OUTER JOIN Z_5TAGS nTag ON note.Z_PK = nTag.Z_5NOTES
	LEFT OUTER JOIN ZSFNOTETAG tag ON nTag.Z_13TAGS = tag.Z_PK
WHERE
	note.ZUNIQUEIDENTIFIER in(
		SELECT
			origin.ZUNIQUEIDENTIFIER FROM ZSFNOTE origin
			JOIN ZSFNOTEBACKLINK link ON origin.Z_PK = link.ZLINKEDBY
			JOIN ZSFNOTE target ON target.Z_PK = link.ZLINKINGTO
		WHERE
			target.ZUNIQUEIDENTIFIER LIKE :id)
GROUP BY
	note.ZUNIQUEIDENTIFIER
ORDER BY
	note.ZMODIFICATIONDATE DESC
LIMIT 400
`,Sr=`
SELECT DISTINCT
  note.ZUNIQUEIDENTIFIER AS id,
  note.ZTITLE AS title,
  note.ZTEXT AS text,
  note.ZMODIFICATIONDATE AS modified_at,
  group_concat(tag.ZTITLE) AS tags
FROM
	ZSFNOTE note
	LEFT OUTER JOIN Z_7TAGS nTag ON note.Z_PK = nTag.Z_7NOTES
	LEFT OUTER JOIN ZSFNOTETAG tag ON nTag.Z_14TAGS = tag.Z_PK
WHERE
	note.ZUNIQUEIDENTIFIER in(
		SELECT
			trgt.ZUNIQUEIDENTIFIER FROM ZSFNOTE src
			JOIN Z_7LINKEDNOTES lnk ON lnk.Z_7LINKEDBYNOTES = src.Z_PK
			JOIN ZSFNOTE trgt ON lnk.Z_7LINKEDNOTES = trgt.Z_PK
		WHERE
			src.ZUNIQUEIDENTIFIER LIKE :id )
GROUP BY
	note.ZUNIQUEIDENTIFIER
ORDER BY
	note.ZMODIFICATIONDATE DESC
LIMIT 400
`,Or=`
SELECT DISTINCT
	note.ZUNIQUEIDENTIFIER AS id,
	note.ZTITLE AS title,
	note.ZTEXT AS text,
	note.ZMODIFICATIONDATE AS modified_at,
	group_concat(tag.ZTITLE) AS tags
FROM
	ZSFNOTE note
	LEFT OUTER JOIN Z_5TAGS nTag ON note.Z_PK = nTag.Z_5NOTES
	LEFT OUTER JOIN ZSFNOTETAG tag ON nTag.Z_13TAGS = tag.Z_PK
WHERE
	note.ZUNIQUEIDENTIFIER in( SELECT DISTINCT
			target.ZUNIQUEIDENTIFIER FROM ZSFNOTE origin
			JOIN ZSFNOTEBACKLINK link ON origin.Z_PK = link.ZLINKEDBY
			JOIN ZSFNOTE target ON target.Z_PK = link.ZLINKINGTO
		WHERE
			origin.ZUNIQUEIDENTIFIER LIKE :id)
GROUP BY
	note.ZUNIQUEIDENTIFIER
ORDER BY
	note.ZMODIFICATIONDATE DESC
LIMIT 400
`,Rr="SELECT name FROM sqlite_master WHERE type='table' AND name=:name",Zr=`
SELECT DISTINCT 
  tags.ZTITLE AS tags 
FROM
  ZSFNOTE AS notes
  LEFT OUTER JOIN Z_7TAGS AS notes_to_tags ON notes.Z_PK = notes_to_tags.Z_7NOTES
  LEFT OUTER JOIN ZSFNOTETAG AS tags ON notes_to_tags.Z_14TAGS = tags.Z_PK 
-- Ignore tags for trashed and archived notes
WHERE notes.ZARCHIVED = 0 AND notes.ZTRASHED = 0
ORDER BY tags.ZTITLE ASC
`,qr=`
SELECT DISTINCT 
  tags.ZTITLE AS tags 
FROM
  ZSFNOTE AS notes
  LEFT OUTER JOIN Z_5TAGS AS notes_to_tags ON notes.Z_PK = notes_to_tags.Z_5NOTES
  LEFT OUTER JOIN ZSFNOTETAG AS tags ON notes_to_tags.Z_13TAGS = tags.Z_PK 
-- Ignore tags for trashed and archived notes
WHERE notes.ZARCHIVED = 0 AND notes.ZTRASHED = 0
ORDER BY tags.ZTITLE ASC
`;var kn=(0,Fr.homedir)()+"/Library/Group Containers/9K33E3U3T4.net.shinyfrog.bear/Application Data/database.sqlite",Dr=978307200;async function Cr(){let b=(0,be.readFileSync)(Mr.default.join(Lr.environment.assetsPath,"sql-wasm.wasm")),d=await(0,Ur.default)({wasmBinary:b}),E=(0,be.readFileSync)(kn);return new we(new d.Database(E))}function Gn(b){if(b.length===0)return"Not Tagged";let d=[];for(let E of b)b.filter(T=>T.includes(E)).length<2&&d.push(E.includes(" ")?`#${E}#`:`#${E}`);return d.join(" ")}var we=class b{database;static searchNotesQueries={v1:gr,v2:vr};static getNoteLinksQueries={v1:Sr,v2:Or};static getNoteBacklinksQueries={v1:Nr,v2:Ar};static getTags={v1:Zr,v2:qr};constructor(d){this.database=d}close(){this.database.close()}toNote(d){let E=d.tags?.split(",")??[],T=d.text??"";return{id:d.id,title:d.title,text:T,modifiedAt:new Date((d.modified_at+Dr)*1e3),createdAt:new Date((d.created_at+Dr)*1e3),tags:E,formattedTags:Gn(E),encrypted:d.encrypted===1,pinned:d.pinned===1,wordCount:[...T.matchAll(/\b\w+\b/g)].length}}tableExists(d){let E=this.database.prepare(Rr);E.bind({":name":d});let T=E.step();return E.free(),T}getBearVersion(){return this.tableExists("Z_5TAGS")?2:1}getNotes(d,E){let T=this.database.prepare(this.getBearVersion()===2?b.searchNotesQueries.v2:b.searchNotesQueries.v1);E?T.bind({":query":`${d}`,":tag":`${E}`}):T.bind({":query":`${d}`});let A=[];for(;T.step();){let o=T.getAsObject();A.push(this.toNote(o))}return T.free(),A.sort((o,Nt)=>o.pinned===Nt.pinned?0:o.pinned?-1:1),A}getTags(){let d=this.database.prepare(this.getBearVersion()===2?b.getTags.v2:b.getTags.v1),E=[];for(;d.step();){let T=d.getAsObject();T.tags!==null&&E.push(T.tags)}return d.free(),E}getBacklinks(d){let E=this.database.prepare(this.getBearVersion()===2?b.getNoteBacklinksQueries.v2:b.getNoteBacklinksQueries.v1);E.bind({":id":d});let T=[];for(;E.step();){let A=E.getAsObject();T.push(this.toNote(A))}return E.free(),T}getNoteLinks(d){let E=this.database.prepare(this.getBearVersion()===2?b.getNoteLinksQueries.v2:b.getNoteLinksQueries.v1);E.bind({":id":d});let T=[];for(;E.step();){let A=E.getAsObject();T.push(this.toNote(A))}return E.free(),T}};function kr(){let[b,d]=(0,vt.useState)(),[E,T]=(0,vt.useState)();return(0,vt.useEffect)(()=>((async()=>{try{d(await Cr())}catch{T(new Error("Couldn't load Bear database. Make sure you have Bear installed."))}})(),()=>b?.close()),[]),[b,E]}var z=require("react/jsx-runtime");function Gr(){let[b,d]=kr(),[E,T]=(0,Yt.useState)();return(0,Yt.useEffect)(()=>{b!=null&&T(b.getNotes(""))},[b]),d&&(0,N.showToast)(N.Toast.Style.Failure,"Something went wrong",d.message),(0,z.jsxs)(N.MenuBarExtra,{isLoading:E==null,icon:{source:"bear-icon.png",tintColor:N.Color.PrimaryText},children:[E?.map(A=>(0,z.jsx)(N.MenuBarExtra.Item,{icon:A.encrypted?N.Icon.Lock:void 0,title:A.title===""?"Untitled Note":A.title.length>40?A.title.substring(0,40)+"\u2026":A.title,subtitle:A.formattedTags,onAction:()=>(0,N.open)(`bear://x-callback-url/open-note?id=${A.id}`)},A.id)),(0,z.jsxs)(N.MenuBarExtra.Section,{children:[(0,z.jsx)(N.MenuBarExtra.Item,{title:"New Note",icon:N.Icon.Plus,shortcut:{modifiers:["cmd"],key:"n"},onAction:()=>(0,N.launchCommand)({name:"new-note",type:N.LaunchType.UserInitiated})}),(0,z.jsx)(N.MenuBarExtra.Item,{title:"Search",icon:N.Icon.MagnifyingGlass,shortcut:{modifiers:["cmd"],key:"s"},onAction:()=>(0,N.open)("bear://x-callback-url/search")}),(0,z.jsx)(N.MenuBarExtra.Item,{title:"Configure Command",icon:N.Icon.Gear,shortcut:{modifiers:["cmd"],key:","},onAction:N.openCommandPreferences})]})]})}
